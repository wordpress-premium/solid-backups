var pb_backupbuddy_selectdestination;!function(e,t){if("onprogress"in e.ajaxSettings.xhr()){var a=e.ajaxSettings.xhr;e.ajaxSettings.xhr=function(){var e=a.apply(this,arguments);return e instanceof t.XMLHttpRequest&&e.addEventListener("progress",this.progress,!1),e.upload&&e.upload.addEventListener("progress",this.progress,!1),e}}}(jQuery,window),function(c,s){"use strict";var l="stickyTableHeaders",a=0,i={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,objHead:"head",objWindow:s,scrollableArea:s,cacheHeaderHeight:!1,zIndex:3};c.fn[l]=function(t){return this.each(function(){var e=c.data(this,"plugin_"+l);e?"string"==typeof t?e[t].apply(e):e.updateOptions(t):"destroy"!==t&&c.data(this,"plugin_"+l,new function(e,t){var u=this;u.$el=c(e),u.el=e,u.id=a++,u.$el.bind("destroyed",c.proxy(u.teardown,u)),u.$clonedHeader=null,u.$originalHeader=null,u.cachedHeaderHeight=null,u.isSticky=!1,u.hasBeenSticky=!1,u.leftOffset=null,u.topOffset=null,u.init=function(){u.setOptions(t),u.$el.each(function(){var e=c(this);e.css("padding",0),u.$originalHeader=c("thead:first",this),u.$clonedHeader=u.$originalHeader.clone(),e.trigger("clonedHeader."+l,[u.$clonedHeader]),u.$clonedHeader.addClass("tableFloatingHeader"),u.$clonedHeader.css({display:"none",opacity:0}),u.$originalHeader.addClass("tableFloatingHeaderOriginal"),u.$originalHeader.after(u.$clonedHeader),u.$printStyle=c('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),u.$head.append(u.$printStyle)}),u.$clonedHeader.find("input, select").attr("disabled",!0),u.updateWidth(),u.toggleHeaders(),u.bind()},u.destroy=function(){u.$el.unbind("destroyed",u.teardown),u.teardown()},u.teardown=function(){u.isSticky&&u.$originalHeader.css("position","static"),c.removeData(u.el,"plugin_"+l),u.unbind(),u.$clonedHeader.remove(),u.$originalHeader.removeClass("tableFloatingHeaderOriginal"),u.$originalHeader.css("visibility","visible"),u.$printStyle.remove(),u.el=null,u.$el=null},u.bind=function(){u.$scrollableArea.on("scroll."+l,u.toggleHeaders),u.isWindowScrolling||(u.$window.on("scroll."+l+u.id,u.setPositionValues),u.$window.on("resize."+l+u.id,u.toggleHeaders)),u.$scrollableArea.on("resize."+l,u.toggleHeaders),u.$scrollableArea.on("resize."+l,u.updateWidth)},u.unbind=function(){u.$scrollableArea.off("."+l,u.toggleHeaders),u.isWindowScrolling||(u.$window.off("."+l+u.id,u.setPositionValues),u.$window.off("."+l+u.id,u.toggleHeaders)),u.$scrollableArea.off("."+l,u.updateWidth)},u.debounce=function(a,i){var d=null;return function(){var e=this,t=arguments;clearTimeout(d),d=setTimeout(function(){a.apply(e,t)},i)}},u.toggleHeaders=u.debounce(function(){u.$el&&u.$el.each(function(){var e,t,a,i=c(this),d=u.isWindowScrolling?isNaN(u.options.fixedOffset)?u.options.fixedOffset.outerHeight():u.options.fixedOffset:u.$scrollableArea.offset().top+(isNaN(u.options.fixedOffset)?0:u.options.fixedOffset),n=i.offset(),r=u.$scrollableArea.scrollTop()+d,o=u.$scrollableArea.scrollLeft(),s=u.isWindowScrolling?r>n.top:d>n.top;s&&(t=u.options.cacheHeaderHeight?u.cachedHeaderHeight:u.$clonedHeader.height(),a=(u.isWindowScrolling?r:0)<n.top+i.height()-t-(u.isWindowScrolling?0:d)),s&&a?(e=n.left-o+u.options.leftOffset,u.$originalHeader.css({position:"fixed","margin-top":u.options.marginTop,top:0,left:e,"z-index":u.options.zIndex}),u.leftOffset=e,u.topOffset=d,u.$clonedHeader.css("display",""),u.isSticky||(u.isSticky=!0,u.updateWidth(),i.trigger("enabledStickiness."+l)),u.setPositionValues()):u.isSticky&&(u.$originalHeader.css("position","static"),u.$clonedHeader.css("display","none"),u.isSticky=!1,u.resetWidth(c("td,th",u.$clonedHeader),c("td,th",u.$originalHeader)),i.trigger("disabledStickiness."+l))})},0),u.setPositionValues=u.debounce(function(){var e=u.$window.scrollTop(),t=u.$window.scrollLeft();!u.isSticky||e<0||e+u.$window.height()>u.$document.height()||t<0||t+u.$window.width()>u.$document.width()||u.$originalHeader.css({top:u.topOffset-(u.isWindowScrolling?0:e),left:u.leftOffset-(u.isWindowScrolling?0:t)})},0),u.updateWidth=u.debounce(function(){if(u.isSticky){u.$originalHeaderCells||(u.$originalHeaderCells=c("th,td",u.$originalHeader)),u.$clonedHeaderCells||(u.$clonedHeaderCells=c("th,td",u.$clonedHeader));var e=u.getWidth(u.$clonedHeaderCells);u.setWidth(e,u.$clonedHeaderCells,u.$originalHeaderCells),u.$originalHeader.css("width",u.$clonedHeader.width()),u.options.cacheHeaderHeight&&(u.cachedHeaderHeight=u.$clonedHeader.height())}},0),u.getWidth=function(e){var o=[];return e.each(function(e){var t,a=c(this);if("border-box"===a.css("box-sizing")){var i=a[0].getBoundingClientRect();t=i.width?i.width:i.right-i.left}else if("collapse"===c("th",u.$originalHeader).css("border-collapse"))if(s.getComputedStyle)t=parseFloat(s.getComputedStyle(this,null).width);else{var d=parseFloat(a.css("padding-left")),n=parseFloat(a.css("padding-right")),r=parseFloat(a.css("border-width"));t=a.outerWidth()-d-n-r}else t=a.width();o[e]=t}),o},u.setWidth=function(a,e,i){e.each(function(e){var t=a[e];i.eq(e).css({"min-width":t,"max-width":t})})},u.resetWidth=function(e,a){e.each(function(e){var t=c(this);a.eq(e).css({"min-width":t.css("min-width"),"max-width":t.css("max-width")})})},u.setOptions=function(e){u.options=c.extend({},i,e),u.$window=c(u.options.objWindow),u.$head=c(u.options.objHead),u.$document=c(u.options.objDocument),u.$scrollableArea=c(u.options.scrollableArea),u.isWindowScrolling=u.$scrollableArea[0]===u.$window[0]},u.updateOptions=function(e){u.setOptions(e),u.unbind(),u.bind(),u.updateWidth(),u.toggleHeaders()},u.init()}(this,t))})}}(jQuery,window),(BackupBuddy=window.BackupBuddy||{}).Backups=function(r){"use strict";var e=function(){r(".pb_backupbuddy_hoveraction_send").on("click",function(e){return e.preventDefault(),tb_show("BackupBuddy",BackupBuddy.Vars.get("ajax.destination_picker")+"&callback_data="+r(this).attr("rel")+"&sending=1&action_verb=to%20send%20to&TB_iframe=1&width=640&height=455",null),!1}),r("a.remote-send").off("click").on("click",function(e){e.preventDefault();var t=r(this).attr("data-backup-zip");return tb_show("BackupBuddy",BackupBuddy.Vars.get("ajax.destination_picker")+"&callback_data="+t+"&sending=1&action_verb=to%20send%20to&TB_iframe=1&width=640&height=455",null),!1})},t=function(){r(".backup-actions").off("click").on("click",function(e){e.preventDefault(),r(".backup-actions-menu.open").removeClass("open"),r(".backup-actions.active").not(r(this)).removeClass("active"),r(this).hasClass("active")?(r(this).removeClass("active"),r(this).blur()):(r(this).addClass("active"),r(this).next(".backup-actions-menu").addClass("open"))}),r(document).on("mouseup",function(e){if(r(e.target).hasClass("backup-actions"))return!0;r(".backup-actions-menu").removeClass("open"),r(".backup-actions.active").removeClass("active"),r(".backup-actions").blur()})},a=function(){r(".pb_backupbuddy_hoveraction_hash").on("click",function(e){return e.preventDefault(),tb_show("BackupBuddy",BackupBuddy.Vars.get("ajax.hash")+"&callback_data="+r(this).attr("rel")+"&TB_iframe=1&width=640&height=455",null),!1})},i=function(){r(".pb_backupbuddy_hoveraction_note").on("click",function(e){e.preventDefault();var t=r(this).parents("td").find(".pb_backupbuddy_notetext").text();""==t&&(t="My first backup");var a=prompt(BackupBuddy.Vars.get("strings.note_instructions"),t);return null==a||""==a||(r(".pb_backupbuddy_backuplist_loading").show(),r.post(BackupBuddy.Vars.get("ajax.set_backup_note"),{backup_file:r(this).attr("rel"),note:a},function(e){e=r.trim(e),r(".pb_backupbuddy_backuplist_loading").hide(),"1"!=e&&alert(BackupBuddy.Vars.get("strings.error")+": "+e),location.reload(!0)})),!1})},d=function(){r(".profile_item_cancel_add_select").off("click").on("click",function(e){e.preventDefault(),r("#pb_backupbuddy_profileadd").hide(),r("#pb_backupbuddy_profileadd_plusbutton").show()})},o=function(){r('a[href$="#backup-details"]').off("click").on("click",function(e){e.preventDefault();var t=r("<span />").addClass("spinner").css("float","none").css("visibility","visible").css("margin-top","-1px"),a=r("<div />").addClass("backupbuddy-backup-details loading").append(t).append("Loading..."),i=r(this).attr("data-backup-zip"),d=r(this).attr("data-destination-id");BackupBuddy.Modal.open({title:"Backup Details",content:a}),r.ajax({url:BackupBuddy.Vars.get("ajax.backup_info"),data:{backup:i,destination:d,return:"html"},success:function(e){if(a.removeClass("loading"),e.success)a.html(e.html);else{var t=void 0===e.error?"Could not retrieve backup detail.":e.error;a.addClass("failed").html(t)}}})})},n=function(){var e=r(".backupbuddy-tabs .restore-backup");if(e.length&&!r("#backupbuddy-data-browser").length&&!r("#backupbuddy-restore-status").hasClass("open")){var t=BackupBuddy.Vars.get("destination_ids");if(t.length&&!e.data("remote-loaded")){e.data("remote-loaded",!0);for(var d=[],a=0;a<t.length;a++)d[a]=!0;var n=[];r(".restore-backups-table tbody tr:not(.hidden)").each(function(){n[n.length]=r(this).attr("data-id")}),s(d);for(var i=0;i<t.length;i++)r.ajax({url:BackupBuddy.Vars.get("ajax.remote_backups"),data:{mode:"restore",destination_id:t[i],index:i},success:function(e){if(e.success&&e.backups.length){var t,a=!!r(".restore-backups-table table").length;for(t=0;t<e.backups.length;t++)if(!1!==a||void 0===e.backups[t].restore){r(e.backups[t].restore).find("tbody tr").each(function(){var e=r(this),t=e.data("id");if(0<=r.inArray(t,n))e.addClass("hidden");else{n[n.length]=t;var a=parseInt(e.attr("data-timestamp")),i=r(".restore-backups-table tbody tr").filter(function(){return parseInt(r(this).attr("data-timestamp"))<=a}).first();i.length?i.before(e):r(".restore-backups-table tbody").append(e)}})}else{var i=r(".restore-backups-table");i.length||(i=r("<div />").addClass("restore-backups-table"),r("#backupbuddy-restore-status").length?r("#backupbuddy-restore-status").after(i):r("#restore-backup").prepend(i)),r("#restore-backup .no-backups-created").remove(),i.html(e.backups[t].restore),a=!0}o(),BackupBuddy.Restore.bind_restore_buttons()}r("#restore-backup th.stash-traditional-backup-files").length&&r("#restore-backup th.stash-traditional-backup-files:first").html(r("#restore-backup th.stash-traditional-backup-files:first").html().replace(BackupBuddy.Vars.get("strings.stash_table_header"),BackupBuddy.Vars.get("strings.backups_table_header"))),d[e.index]=!1,s(d),c()}})}}},s=function(e){for(var t=!1,a=r(".backupbuddy-tabs .restore-backup"),i=0;i<e.length;i++)if(e[i]){t=!0;break}t?a.length&&a.addClass("processing"):a.removeClass("processing")},u=function(){var a=r(".backupbuddy-generate-dat");if(a.length){var i=a.data("zip");i&&r.ajax({url:BackupBuddy.Vars.get("ajax.create-dat"),data:{zip_file:i},success:function(e){if(e.success){var t=BackupBuddy.Vars.get("page_url");t+="&dat_viewer="+encodeURI(i),t+="&value="+encodeURI(i),window.location.href=t}else a.hide(),r(".legacy-file-restore-wrapper").show(),backupbuddy_legacy_file_browser()}})}},c=function(){for(var e=["#backups-main table.minimal",".restore-backups-table",".bb-iframe-divpadding-noscroll table.minimal"],t=0;t<e.length;t++){r(e[t]+" .separator").removeClass("separator"),r(e[t]+" .begin-month").removeClass("begin-month");var a="",i=0;r(e[t]+" tbody tr").each(function(e){var t=r(this).attr("class").split(" ").filter(function(e){return-1<e.indexOf("month-")});t[0]!==a?(a=t[0],(i=0)!==e&&r(this).addClass("begin-month")):i++,5===i&&(i=0,r(this).addClass("separator"))})}};return pb_backupbuddy_selectdestination=function(e,t,a,i,d){if(""!=a&&"delayed_send"!=a){if("importbuddy.php"===a){var n=r('<div id="pb_backupbuddy_ib_sent" class="pb_backupbuddy_alert updated fade">'+BackupBuddy.Vars.get("strings.sending_importbuddy")+"</div>");return r("h1:first").after(n),r.ajax({url:BackupBuddy.Vars.get("ajax.send_importbuddy"),data:{destination_id:e,destination_title:t,callback_data:a},success:function(e){(n=r("#pb_backupbuddy_ib_sent")).html(e.notice),e.success||n.removeClass("updated").addClass("error")}}),!1}r.post(BackupBuddy.Vars.get("ajax.remote_send"),{destination_id:e,destination_title:t,file:a,trigger:"manual",delete_after:i},function(e){if("1"!=(e=r.trim(e)).charAt(0))alert(BackupBuddy.Vars.get("strings.remote_send_error")+":\n\n"+e);else{var t=" "+BackupBuddy.Vars.get("strings.local_delete_upon_success");i||(t=""),alert(BackupBuddy.Vars.get("strings.remote_send_confirmed")+t+"\n\n"+e.slice(1)),r.post(BackupBuddy.Vars.get("ajax_base"))}})}else"delayed_send"==a?(r("#pb_backupbuddy_backup_remotedestination").val(e),r("#pb_backupbuddy_backup_deleteafter").val(i),r("#pb_backupbuddy_backup_remotetitle").html('Destination: "'+t+'".')):window.location.href=BackupBuddy.Vars.get("admin_url")+"?page=pb_backupbuddy_backup&custom=remoteclient&destination_id="+e},{init:function(){e(),a(),i(),d(),o(),t(),n(),u(),c()}}}(jQuery),jQuery(window).on("load",BackupBuddy.Backups.init);var BackupBuddy=window.BackupBuddy||{},MutationObserver=window.MutationObserver||window.WebKitMutationObserver;BackupBuddy.Core=function(p){"use strict";function a(){p(".backupbuddy-admin-notices").is(":empty")&&(p(".backupbuddy-admin-notices").remove(),p(".backupbuddy-admin-notices-toggle").remove())}function t(){p(".backupbuddy-internal-notices").is(":empty")&&p(".backupbuddy-internal-notices").remove()}var e=function(){var e=new MutationObserver(i),t=p(".backupbuddy-admin-page #wpcontent").first();t.length&&(i(),e.observe(t[0],{childList:!0,subtree:!0}))},i=function(){var e=p(".backupbuddy-admin-page #wpbody-content > #dolly"),t=p(".backupbuddy-admin-page #wpcontent > *").first().nextUntil(".backupbuddy-admin-page #wpbody"),a=p(".backupbuddy-admin-page #wpbody-content > *").first().nextUntil(".backupbuddy-admin-page #wpbody-content > .wrap:first"),i=p(".backupbuddy-admin-page #wpbody-content > .wrap > *").first(),d="h1"===i.prop("tagName").toLowerCase()?p():i.nextUntil(".backupbuddy-admin-page #wpbody-content > .wrap > h1:first"),n=p(".backupbuddy-admin-page .backupbuddy-tabs").length?".backupbuddy-admin-page .backupbuddy-tabs":p(".backupbuddy-admin-page .backupbuddy_api_key-hide").length?".backupbuddy-admin-page .backupbuddy_api_key-hide":!!p(".backupbuddy-admin-page .bb_progress-bar").length&&".backupbuddy-admin-page .bb_progress-bar",r=n?p(".backupbuddy-admin-page #wpbody-content > .wrap > h1:first").nextUntil(n):p(),o=t.add(a).add(d).add(r).filter(":not( .bb-topbar-title, .backupbuddy-admin-notices, script, link, .clear, #wpbody, #wpadminbar, #screen-meta, #screen-meta-links, .backupbuddy_api_key-hide, #dolly, :empty, .bub-notice-moved )"),s=o.filter(':not( [class*="backupbuddy"] )').filter(":visible"),u=o.filter('[class*="backupbuddy"]').filter(":visible");if(e.length&&e.css("padding-top","0").css("padding-right","25px").appendTo(".bb-topbar-title"),s.length||u.length){if(s.length){var c=f();if(!c.length)return void console.error("There was a problem initializing BackupBuddy Admin Notices.");s.each(function(){var e=p(this);e.addClass("bub-notice-moved"),e.html()&&!p.contains(c,e)&&c.append(e)}),p(".backupbuddy-admin-notices-toggle .count").html(c.children().length)}if(u.length){var l=b();if(!l.length)return void console.error("There was a problem initializing BackupBuddy Notices.");u.each(function(){l.append(p(this)),p(this).addClass("bub-notice-moved")})}}},b=function(){var e=p(".backupbuddy-internal-notices");e.length||(e=p("<div />").addClass("backupbuddy-internal-notices"),p(".backupbuddy-tabs .tab-controls").length?p(".backupbuddy-tabs .tab-controls").after(e):p(".backupbuddy-admin-page #wpbody-content > .wrap > h1:first").after(e),new MutationObserver(t).observe(e[0],{childList:!0,subtree:!0}));return e},f=function(){var t=p(".backupbuddy-admin-notices"),e=p(".backupbuddy-admin-notices-toggle");t.length||(t=p("<div />").addClass("backupbuddy-admin-notices"),p(".backupbuddy-tabs .tab-controls").length?p(".backupbuddy-tabs .tab-controls").after(t):p(".backupbuddy-admin-page #wpbody-content > .wrap > h1:first").after(t),new MutationObserver(a).observe(t[0],{childList:!0,subtree:!0}));return e.length||(p("#screen-meta-links").append('<div class="backupbuddy-meta-link-wrap hide-if-no-js backupbuddy-admin-notices-toggle"><a href="#admin-notices" class="button show-settings"><span class="count"></span>'+BackupBuddy.Vars.get("strings.admin_notices")+"</a></div>"),(e=p(".backupbuddy-admin-notices-toggle")).on("click",function(e){e.preventDefault(),p(this).find("a:first").toggleClass("screen-meta-active"),t.toggleClass("open")})),t},d=function(){BackupBuddy.Vars.get("hide_quick_setup")||p("#screen-meta-links").append('<div class="backupbuddy-meta-link-wrap hide-if-no-js screen-meta-toggle"><a href="?page=pb_backupbuddy_backup&wizard=1" class="show-settings no-dropdown">'+BackupBuddy.Vars.get("strings.quick_setup")+"</a></div>")},n=function(){var e=p("<a />").attr("href","#importbuddy").addClass("show-settings").text(BackupBuddy.Vars.get("strings.importbuddy")),t=p("<div/>").addClass("backupbuddy-meta-link-wrap hide-if-no-js screen-meta-toggle"),a=p("<div />").addClass("hover-menu"),i=p("<a />").addClass("download-importbuddy").attr("href",BackupBuddy.Vars.get("ajax.importbuddy")).text(BackupBuddy.Vars.get("strings.importbuddy_download")),d=p("<a />").addClass("send-importbuddy").attr("href",BackupBuddy.Vars.get("ajax.destination_picker")).text(BackupBuddy.Vars.get("strings.importbuddy_send")).attr("rel","importbuddy.php");e.on("click",function(e){e.preventDefault()}),i.on("click",function(e){e.preventDefault();var t,a=p(this).attr("href");return BackupBuddy.Vars.get("importbuddy_pass_set")?(null!=(t=prompt(BackupBuddy.Vars.get("strings.importbuddy_prompt_haspass")))&&(window.location.href=a+"&p="+encodeURIComponent(t)),!1):null!=(t=prompt(BackupBuddy.Vars.get("strings.importbuddy_prompt_nopass")))&&""!=t?void(window.location.href=a+"&p="+encodeURIComponent(t)):(""==t&&alert(BackupBuddy.Vars.get("strings.importbuddy_no_password")),!1)}),d.on("click",function(e){if(e.preventDefault(),!BackupBuddy.Vars.get("importbuddy_pass_set"))return alert("You must set an ImportBuddy password via the BackupBuddy settings page before you can send this file."),!1;var t=p(this).attr("href"),a=p(this).attr("rel");return a&&("importbuddy.php"!==a&&(t+="&action_verb=to%20send%20to"),t+="&callback_data="+a),t+="&sending=1&TB_iframe=1&width=640&height=455",tb_show("BackupBuddy",t,null),!1}),a.append(i).append(d),e.append(a),t.append(e),p("#screen-meta-links").append(t)};return{init:function(){p("body").hasClass("toplevel_page_pb_backupbuddy_backup")&&(d(),n()),e()},init_observers:e}}(jQuery),jQuery(window).on("load",BackupBuddy.Core.init),(BackupBuddy=window.BackupBuddy||{}).Diagnostics=function(i){"use strict";var a="backupbuddy_page_pb_backupbuddy_diagnostics",e=function(){i('.backupbuddy_page_pb_backupbuddy_diagnostics a[href="#extraneous-log"]').off("click").on("click",function(e){e.preventDefault(),i("#backupbuddy-extra-log").slideToggle("fast"),i("#backupbuddy_logFile").attr("data-loaded")||d()}),i('.backupbuddy_page_pb_backupbuddy_diagnostics a[href="#remoteapi-log"]').off("click").on("click",function(e){e.preventDefault(),i("#backupbuddy-remoteapi-log").slideToggle("fast"),i("#backupbuddy_remoteapi_logFile").attr("data-loaded")||n()}),i('.backupbuddy_page_pb_backupbuddy_diagnostics a[href="#hide"]').off("click").on("click",function(e){e.preventDefault();var t=i(this).data("log");"main"===t?i("#backupbuddy-extra-log").slideToggle("fast"):"remote"===t&&i("#backupbuddy-remoteapi-log").slideToggle("fast")})},t=function(){i(document).on("backupbuddy.tabs.switch",function(e,t){i("body").hasClass(a)})},d=function(e){e=void 0===e?0:e,i("#backupbuddy_logFile").length&&i.post(BackupBuddy.Vars.get("ajax.getMainLog"),{confirmed:e},function(e){"string"!=typeof e?confirm("WARNING: Log file is very large ("+e.size+"). This could take a while to load. Are you sure you want to continue?")?d(1):i("#backupbuddy-extra-log").slideToggle("fast"):i("#backupbuddy_logFile").text(e).attr("data-loaded","true")})},n=function(e){e=void 0===e?0:e,i("#backupbuddy_remoteapi_logFile").length&&i.post(BackupBuddy.Vars.get("ajax.getRemoteApiLog"),{confirmed:e},function(e){"string"!=typeof e?confirm("WARNING: Log file is very large ("+e.size+"). This could take a while to load. Are you sure you want to continue?")?n(1):i("#backupbuddy-remoteapi-log").slideToggle("fast"):i("#backupbuddy_remoteapi_logFile").text(e).attr("data-loaded","true")})},r=function(){i('a[href="#reset-log"]').off("click").on("click",function(e){if(e.preventDefault(),!confirm("Are you sure you want to reset this log?"))return!1;var t=i(this).data("log");!function(e,t,a){i.post(BackupBuddy.Vars.get("ajax.reset_log"),{log:e},function(e){e.success&&t?t():(e.error&&alert(e.error),a&&a())})}(t,function(){i('textarea[data-log-file="'+t+'"]').text("-- Log Reset --"),"main"===t?i("#backupbuddy_logFile").removeAttr("data-loaded"):"remote"===t&&i("#backupbuddy_remoteapi_logFile").removeAttr("data-loaded")})})};return{init:function(){e(),t(),r()},load_logs:function(){d(),n()}}}(jQuery),jQuery(window).on("load",BackupBuddy.Diagnostics.init),(BackupBuddy=window.BackupBuddy||{}).File_Viewer=function(r){"use strict";var e=function(){r(document).on("backupbuddy.modal.close",function(){r(".backupbuddy-file-viewer .CodeMirror").remove(),r(".backupbuddy-file-viewer .file-contents").remove(),r(".backupbuddy-file-viewer .file-preview").remove()})},t=function(){r("a.view-file").off("click").on("click",function(e){e.preventDefault();var t=r(this);!function(e,t,a,i){var d=r("<div />").addClass("backupbuddy-file-viewer").addClass("mode-"+a);if("code"===a){var n=r("<textarea />").addClass("file-contents loading").val("Loading...").attr("readonly","readonly");d.append(n),n=d.find(".file-contents")}else{n=r("<div />").addClass("file-preview loading").html("Loading...");d.append(n),n=d.find(".file-preview")}BackupBuddy.Modal.open({content:d,title:t}),r.ajax({url:BackupBuddy.Vars.get("ajax.get_file"),data:{backup:e,path:t,mode:a,type:i},success:function(e){if(void 0!==e.warning){r("<div />").addClass("warning").html(e.warning);console.log(e.warning)}if(e.success)if(n.removeClass("loading"),"code"===a){n.val(e.contents),BackupBuddy.Modal.set_size("max");var t=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};t.codemirror=_.extend({},t.codemirror,{indentUnit:1,tabSize:4,mode:e.mode,indentWithTabs:!0,readOnly:!0});wp.codeEditor.initialize(n,t)}else BackupBuddy.Modal.content(e.contents);else if(void 0!==e.error){r("<div />").addClass("error").html(e.error);console.log(e.error),d.hide()}}})}(r("#backupbuddy-data-browser form").attr("data-zip"),t.attr("data-path"),t.attr("data-mode"),t.attr("data-type"))})};return{init:function(){t(),e()}}}(jQuery),jQuery(window).on("load",BackupBuddy.File_Viewer.init),(BackupBuddy=window.BackupBuddy||{}).FileTree=function(c){"use strict";function l(e){var t=c("<span/>").addClass("spinner");e.append(t)}function p(e){return e.find(".spinner").length}function b(e){e.find(".spinner").remove()}function f(e){var t=e.attr("href").replace("#","");e.toggleClass("open"),e.hasClass("open")?c('tr[data-parent-id="'+t+'"].hidden').removeClass("hidden"):(c('tr[data-parent-id^="'+t+'"]:not(.hidden)').addClass("hidden"),c('tr[data-parent-id^="'+t+'"] a.folder-toggle.open').removeClass("open"))}function g(e,t){e.toggleClass("open"),t.toggleClass("expanded"),t.find("ul:first").toggleClass("open")}function k(e,t){t=void 0===t?250:t,setTimeout(function(){c(".backupbuddy-file-tree").css("height",e.outerHeight(!0))},t)}var h=function(e){return c('.panel[data-path="'+e+'"]').length},y=function(e,t){var a=c('.panel[data-path="'+e+'"]'),i=c(".panel.active");if(t=void 0===t?"forward":"back",a.length&&i.length){a.addClass("instant");"forward"===t?setTimeout(function(){a.removeClass("inactive").addClass("next"),setTimeout(function(){a.removeClass("instant"),setTimeout(function(){i.addClass("inactive").removeClass("active"),a.addClass("active").removeClass("next")},5)},5)},5):setTimeout(function(){a.removeClass("next").addClass("inactive"),setTimeout(function(){a.removeClass("instant"),setTimeout(function(){i.addClass("next").removeClass("active"),a.addClass("active").removeClass("inactive")},5)},5)},5),k(a,265)}},m=function(e,d,n){var t=c("#backupbuddy-file-tree"),a=c("#backupbuddy-data-browser > form"),i=!!a.attr("data-zip")&&a.attr("data-zip"),r=!!a.attr("data-serial")&&a.attr("data-serial"),o=c('input[name="backupbuddy_restore_destination"]').val(),s=t.hasClass("panels"),u=void 0===d?"inside":"after";i&&r&&(e=void 0===e?"__root__":e,d=void 0===d?t:d,s&&(u="append",d=t),c.ajax({url:BackupBuddy.Vars.get("ajax.file_tree"),data:{dat_viewer:i,path:e,serial:r,destination:o},success:function(e){if("inside"===u)d.html(e);else if("after"===u)d.after(e);else if("append"===u){var t=".panel.incoming",a=240;d.hasClass("loading")&&(d.html(""),t=".panel",a=10),d.find(".panel.active").addClass("inactive").removeClass("active"),d.append(e);var i=d.find(t);setTimeout(function(){i.addClass("active").removeClass("incoming")},5),k(i,a)}d.removeClass("loading"),c('.backupbuddy-file-tree a.folder-toggle:not([data-bound="true"])').each(function(){var n=c(this),r=c(".backupbuddy-file-tree table").length?"table":"list";n.attr("data-bound","true"),n.on("click",function(e){if(e.preventDefault(),!n.hasClass("disabled")){var t=n.attr("href").replace("#","");if(h(t))y(t);else if("list"==r){var a=n.parents("li:first"),i=n.parent("div");if(p(i))return;a.find("ul:first").length?g(n,a):(l(i),m(a.attr("data-dir"),i,function(){g(n,a),b(i)}))}else{if(p(n))return;if(c('tr[data-parent-id="'+t+'"]').length)f(n);else{var d=n.parents("tr:first");l(n),m(d.attr("data-dir"),d,function(){f(n),b(n)})}}}})}),c('.backupbuddy-file-tree a.breadcrumb:not([data-bound="true"])').each(function(){var a=c(this);a.attr("data-bound","true"),a.on("click",function(e){if(e.preventDefault(),!a.hasClass("disabled")){var t=a.attr("href").replace("#","");h(t)&&y(t,"back")}})}),1===c("ul#tree_root > li").length?c("ul#tree_root > li > a.folder-toggle").trigger("click"):1===c("table#tree_root tbody tr").length&&c("table#tree_root tbody tr a.folder-toggle").trigger("click"),c('.backupbuddy-file-tree input[type="checkbox"]:not([data-toggler-bound="true"])').each(function(){var i=c(this),d=c(".backupbuddy-file-tree > table").length?"table":"list";i.attr("data-toggler-bound","true"),i.on("change",function(){if("list"==d)i.parents("li:first").find('ul:first input[type="checkbox"]'),i.parents("li:first").parent("ul").parent("li").find('input[type="checkbox"]:first');else{var e=i.parents("tr:first"),t=e.attr("id")?e.attr("id").replace("dir_",""):"",a=(t&&c('tr[data-parent-id^="'+t+'"] input[type="checkbox"]'),e.attr("data-parent-id"));c("#dir_"+a).find('input[type="checkbox"]:first')}})}),setTimeout(BackupBuddy.FileTree.sticky_headers,500),BackupBuddy.Restore.init(),BackupBuddy.File_Viewer.init(),"function"==typeof n&&n()}}))},e=function(){var e=c("#backupbuddy-data-browser > form"),t=e.attr("data-zip")?e.attr("data-zip"):BackupBuddy.Vars.get("backup_zip");t&&c.ajax({url:BackupBuddy.Vars.get("ajax.backup_info"),data:{backup:t,serial:BackupBuddy.Vars.get("backup_serial")},success:function(e){var t=c(".backup-size"),a=c(".backup-wp-version");e.success&&(void 0!==e.info.size&&t.hide().html(e.info.size).fadeIn("fast"),void 0!==e.info.wp_version&&a.hide().html(BackupBuddy.Vars.get("strings.wp_version")+" "+e.info.wp_version).fadeIn("fast"))}})};return{init:function(){m(),e()},sticky_headers:function(){var t=!1,a=!1,e=c("#backupbuddy-file-tree.panels").length;if(c(d=e?"#backupbuddy-file-tree .panel.active table":"#backupbuddy-file-tree table").length){e&&c("#backupbuddy-file-tree table").stickyTableHeaders("destroy"),c(d).stickyTableHeaders({fixedOffset:c("#wpadminbar")});var i=c(".tableFloatingHeaderOriginal")}else{var d;i=c(d=e?".panel.active .list-header":".list-header");t=i.width(),a=i.outerHeight()}if(i.length&&!i.attr("data-is-sticky")){i.attr("data-is-sticky",!0);var n=i.offset().top-c("#wpadminbar").outerHeight(),r=c("#backupbuddy-data-browser");c(window).on("scroll",function(){var e=c(window).scrollTop();n<e&&r.height()+r.offset().top-i.height()>e?(i.addClass("stuck"),t&&i.css("width",t),a&&r.css("padding-top",a)):(i.removeClass("stuck").removeAttr("style"),r.removeAttr("style"),t=t&&i.width(),a=a&&i.outerHeight())})}}}}(jQuery),jQuery(window).on("load",BackupBuddy.FileTree.init),function(i){"use strict";i.fn.serializeObject=function(){var e=this.serializeArray(),t={},a=[];return i.each(e,function(){var e;e=null!=this.value?this.value:"",0<=this.name.indexOf("[]")&&(this.name=this.name.replace("[]",""),a.push(this.name)),null!=t[this.name]&&a.includes(this.name)?(t[this.name].push||(t[this.name]=[t[this.name]]),t[this.name].push(e)):t[this.name]=e}),t}}(jQuery);var pb_backupbuddy_profile_updated,backupbuddy_is_dir=function(e){return"/"===e.substr(e.length-1)},backupbuddy_trim_slashes=function(e){return e.replace(/^\/+|\/+$/g,"")},backupbuddy_basename=function(e,t){t=void 0!==t&&t;var a=new String(e);return a=(a=backupbuddy_trim_slashes(a)).substring(a.lastIndexOf("/")+1),t&&-1!=a.lastIndexOf(".")&&(a=a.substring(0,a.lastIndexOf("."))),a},backupbuddy_autoscroll=function(e){e.scrollTop(e[0].scrollHeight)},backupbuddy_oauth_window=function(e,t,a,i){var d=null!=window.screenLeft?window.screenLeft:window.screenX,n=null!=window.screenTop?window.screenTop:window.screenY,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=r/window.screen.availWidth,u=(r-a)/2/s+d,c=(o-i)/2/s+n,l=window.open(e,t,"scrollbars=no, width="+a/s+", height="+i/s+", top="+c+", left="+u);return window.focus&&l.focus(),l};(BackupBuddy=window.BackupBuddy||{}).Modal=function(p){"use strict";var b=!1,f={},t={content:"",theme:"",mode:"",title:"",size:{},strings:{alert_button:"OK",confirm_affirmative:"OK",confirm_negative:"Cancel",prompt_button:"OK"},callbacks:{primary:function(){return k(),!0},secondary:function(){return k(),!1}},close_on_background_click:!0,close_with_esc_key:!0,disable_close_button:!1},a=function(){p("body").addClass("backupbuddy-modal-open"),b.fadeIn("fast",function(){p(document).trigger("backupbuddy.modal.show")})},i=function(e){f=p.extend(!0,{},t,e),n(e),d()},d=function(){!1===b?(b=p(".backupbuddy-modal")).length?(e(),s()):b=o():(e(),s()),f.theme&&b.addClass("theme-"+f.theme),f.mode&&b.addClass("mode-"+f.mode),f.title?u(f.title):b.addClass("no-title"),f.content&&r(f.content),f.size&&c(f.size)},e=function(){b.html(""),b.removeClass("no-title"),b.removeClass(function(e,t){var a=(t.match(/(^|\s)theme-\S+/g)||[]).join(" ");return a=((a=(a.match(/(^|\s)mode-\S+/g)||[]).join(" ")).match(/(^|\s)size-\S+/g)||[]).join(" ")}),p(document).trigger("backupbuddy.modal.reset")},n=function(e){f.mode&&(void 0!==e.size&&void 0!==e.size.width||(f.size.width=500),"alert"===f.mode&&(void 0===e.close_on_background_click&&(f.close_on_background_click=!1),void 0===e.disable_close_button&&(f.disable_close_button=!0)))},r=function(e){e instanceof jQuery||p.isArray(e)?b.find(".backupbuddy-modal-content").html("").append(e):b.find(".backupbuddy-modal-content").html(e)},o=function(){return b=p("<div />").addClass("backupbuddy-modal").hide(),p("#wpwrap").prepend(b),s(),p(document).trigger("backupbuddy.modal.create"),p(".backupbuddy-modal")},s=function(){var e=p("<div />").addClass("backupbuddy-modal-background"),t=p("<div />").addClass("backupbuddy-modal-inner"),a=p("<div />").addClass("backupbuddy-modal-content"),i=p("<h4 />").addClass("backupbuddy-modal-title"),d=p("<a />").addClass("backupbuddy-modal-close").attr("href","#close").html("&times;");if("alert"===f.mode||"confirm"===f.mode||"prompt"===f.mode){var n=p("<div />").addClass("backupbuddy-modal-dialog"),r=p("<div />").addClass("backupbuddy-modal-dialog-body"),o=p("<div />").addClass("backupbuddy-modal-dialog-actions"),s=p("<button />").addClass("button-primary");if(s.on("click",function(e){return e.preventDefault(),g(f.callbacks.primary)}),"alert"===f.mode)var u=s.html(f.strings.alert_button);else if("confirm"===f.mode){var c=p("<button />").addClass("button-secondary").html(f.strings.confirm_negative);c.on("click",function(e){return e.preventDefault(),g(f.callbacks.secondary)});u=[c,s.html(f.strings.confirm_affirmative)]}else if("prompt"===f.mode)u=s.html(f.strings.prompt_button);if(o.append(u),r.append(a),"prompt"===f.mode){var l=p("<input/>").addClass("backupbuddy-modal-prompt-input").attr("type","text");r.append(l)}n.append(r).append(o),a=n}d.on("click",function(e){e.preventDefault(),k()}),e.on("click",function(){f.close_on_background_click&&y()}),f.disable_close_button||t.append(d),t.append(i).append(a),b.append(e).append(t),p(document).trigger("backupbuddy.modal.build")},u=function(e){b.find(".backupbuddy-modal-title").html(e)},c=function(e){if(e&&"string"==typeof e)b.addClass("size-"+e);else if("object"==typeof e){if(void 0===e.width&&void 0===e.height)return;void 0!==e.width&&b.find(".backupbuddy-modal-inner").css("width",e.width),void 0!==e.height&&b.find(".backupbuddy-modal-inner").css("height",e.height)}},g=function(e){"function"==typeof e&&e()},k=function(e){p("body").removeClass("backupbuddy-modal-open"),b&&b.length&&_()?b.fadeOut("fast",function(){g(e),p(document).trigger("backupbuddy.modal.close")}):(g(e),p(document).trigger("backupbuddy.modal.close"))},l=function(){k(function(){h(),p(document).trigger("backupbuddy.modal.destroy")})},h=function(){!1!==b&&(b.length&&(b.remove(),b=!1),p(document).trigger("backupbuddy.modal.remove"))},y=function(){"confirm"===f.mode?f.callbacks.secondary():k()},m=function(){f.close_with_esc_key&&p(document).keyup(function(e){"Escape"===e.key&&y()})},_=function(){return!1!==b&&b.is(":visible")};return{init:function(){m()},open:function(e){_()||l(),i(e),p(document).trigger("backupbuddy.modal.open"),_()||a()},close:k,content:r,destroy:l,set_size:c,find:function(e){return b.find(e)}}}(jQuery),jQuery(window).on("load",BackupBuddy.Modal.init),(BackupBuddy=window.BackupBuddy||{}).New_Backup=function(a){"use strict";pb_backupbuddy_profile_updated=function(e,t){a("#profile_title_"+e).text(t)};var e=function(){a(".profile_item_select").on("click",function(e){e.preventDefault();var t=a(this).attr("href");return t+="&after_destination="+a("#pb_backupbuddy_backup_remotedestination").val(),t+="&delete_after="+a("#pb_backupbuddy_backup_deleteafter").val(),window.location.href=t,!1})},t=function(){a("#pb_backupbuddy_afterbackupremote_box").on("change",function(){a(this).is(":checked")?tb_show("BackupBuddy",BackupBuddy.Vars.get("ajax.destination_picker")+"&callback_data=delayed_send&sending=1&action_verb=to%20send%20to&TB_iframe=1&width=640&height=455",null):(a("#pb_backupbuddy_backup_remotedestination").val(""),a("#pb_backupbuddy_backup_deleteafter").val(""),a("#pb_backupbuddy_backup_remotetitle").html(""))})},i=function(){a("body").on("thickbox:removed",function(){""===a("#pb_backupbuddy_backup_remotedestination").val()&&a("#pb_backupbuddy_afterbackupremote_box").removeAttr("checked")})},d=function(){a(".profile_settings").click(function(e){return tb_show("BackupBuddy",BackupBuddy.Vars.get("ajax.profile_settings")+"&profile="+a(this).attr("rel")+"&callback_data="+a(this).attr("rel")+"&TB_iframe=1&width=640&height=455",null),!1})},n=function(){a("#pb_backupbuddy_profileadd_plusbutton").on("click",function(e){return e.preventDefault(),a(this).hide(),a("#pb_backupbuddy_profileadd").show(),!1})};return{init:function(){e(),t(),i(),d(),n()}}}(jQuery),jQuery(window).on("load",BackupBuddy.New_Backup.init),(BackupBuddy=window.BackupBuddy||{}).Restore=function(s){"use strict";var e=!1,d=0,n=!1,t=0,a=function(){s('.backupbuddy-file-tree input[type="checkbox"]:not([data-restore-bound="true"])').each(function(){var t=s(this);t.attr("data-restore-bound","true"),t.on("change",function(){var e=t.val();t.is(":checked")?i(e):l(e)})})},i=function(e){if(!function(e){return s('#backupbuddy-restore-ui li[data-path="'+e+'"]').length}(e)){var t=o(e),a=backupbuddy_basename(e),i=backupbuddy_is_dir(e),d=s("<em/>").html(a),n=s("<li/>").attr("data-path",e).append(d),r=s("<a />").addClass("remove-file").attr("href","#"+e).html("&#10005;");r.on("click",function(e){e.preventDefault();var t=s(this).attr("href").replace("#","");s('input[value="'+t+'"]').trigger("click")}),n.append(r),i&&n.addClass("folder"),i||"backupbuddy-restore-ui"!==t.attr("id")?t.find("li.folder:last").length?t.find("li.folder:last").after(n):t.append(n):t.find("li.dir").length?t.find("li.dir").before(n):t.append(n),s(".backupbuddy-restore-list .instructions").hide(),s(".backupbuddy-restore-list .button").show(),u(),backupbuddy_autoscroll(s("#backupbuddy-restore-ui"))}},o=function(e){backupbuddy_is_dir(e),e=backupbuddy_trim_slashes(e);var t=r(e),a=s('ul[data-folder="'+t+'"]');return a.length||(a=c(t)),a},r=function(e){return backupbuddy_trim_slashes(e.replace(backupbuddy_basename(e),""))},u=function(){var e=h(),t="Restore";e&&(t+=" "+e),s(".button-restore").val(t)},c=function(e){var t=s("#backupbuddy-restore-ui"),a=s("<li />").attr("data-path",e).addClass("dir").html("<span>"+e+"</span>"),i=s("<ul />").attr("data-folder",e);return e?(a.append(i),t.append(a),i):t},l=function(e){var t=s('#backupbuddy-restore-ui li[data-path="'+e+'"]'),a=t.parent("ul");t.remove(),a.find("li").length||(a.parent("li").remove(),"backupbuddy-restore-ui"!==a.attr("id")&&a.remove()),s("#backupbuddy-restore-ui li").length||(s(".backupbuddy-restore-list .instructions").show(),s(".backupbuddy-restore-list .button").hide()),u()},p=function(){if(!e&&(e=!0,s(".backupbuddy-restore-list").length)){var t=s(".backupbuddy-restore-list"),a=t.offset().top-s("#wpadminbar").outerHeight(),i=s("#backupbuddy-data-browser");s(window).on("scroll",function(){var e=s(window).scrollTop();a<e&&i.height()+i.offset().top-t.height()>e?t.addClass("stuck"):t.removeClass("stuck")})}},b=function(){s("#backupbuddy-restore-status .abort-link").on("click",function(e){if(e.preventDefault(),n)return!1;d=1,s(".restore-current-step").html(BackupBuddy.Vars.get("strings.aborting_restore"))}),s('a[href="#abort-restore"]').on("click",function(e){e.preventDefault();var t=s(this).attr("data-restore-id");s('input[name="abort-'+t+'"]').val("1"),s('.restore-in-progress[data-restore-id="'+t+'"]').html(BackupBuddy.Vars.get("strings.aborting_restore"))})},f=function(){if(s("#backupbuddy-restore-status").hasClass("in-progress")){var e=!!s("#backupbuddy-restore-status").attr("data-restore-id")&&s("#backupbuddy-restore-status").attr("data-restore-id");g(e)}},g=function(i){return void 0===i&&(i=s("#backupbuddy-restore-status").attr("data-restore-id")),i?BackupBuddy.Restore.is_polling?(setTimeout(function(){g(i)},1e3),!1):(BackupBuddy.Restore.is_polling=!0,s(".tab.restore-backup").addClass("processing"),void s.ajax({url:BackupBuddy.Vars.get("ajax.restore_status"),data:{restore_id:i,abort:d},contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){if(BackupBuddy.Restore.is_polling=!1,void 0!==e.success)if(e.overlapping)setTimeout(function(){g(i)},5e3);else if(e.success)!function(e){d&&(e.text=BackupBuddy.Vars.get("strings.aborting_restore")),s(".restore-current-step").html(e.text),e.locked&&(n=!0,s("#backupbuddy-restore-status .abort-link").fadeOut("fast"));var t=s(".progress-dots"),a=!1;if(e.dot&&t.find("."+e.dot).length){if(t=t.find("li"),"failed"===e.end_status)return t.find("li.loading").removeClass("loading"),t.find("li.active:last").removeClass("active").addClass("failed");t.each(function(){if(!0===a)return s(this).addClass("loading"),!1;s(this).addClass("active").removeClass("loading"),s(this).hasClass(e.dot)&&(a=!0)})}}(e.status),e.is_done?function(e){var t=s(".restore-done");if(s(".restore-status-container").css("height",s(".restore-status-container").outerHeight()),"failed"===e.end_status?(t.find(".status-complete").hide(),t.find(".status-failed").show()):"aborted"===e.end_status&&(t.find(".status-complete").hide(),t.find(".status-aborted").show()),e.error)if(t.find("p.error").length)t.find("p.error").html(e.error);else{var a=s("<p/>").addClass("error").html(e.error);t.find("h2.status-failed").after(a)}s(".tab.restore-backup").removeClass("processing"),s(".restore-active").fadeOut("fast",function(){t.fadeIn("fast",function(){s(".restore-status-container").removeAttr("style")})})}(e.status):setTimeout(function(){g(i)},3e3);else{if(void 0!==e.error)return void console.log("Restore Poll Error: "+e.error);i?k(i):console.log("Restore ID is missing.")}else k(i)},statusCode:{404:function(){k(i)},500:function(){k(i)}},error:function(e,t,a){console.log(a),k(i)}}).fail(function(e,t,a){console.log(a),k(i)})):(console.log("Missing restore ID."),!1)},k=function(e){BackupBuddy.Restore.is_polling=!1,++t<5?setTimeout(function(){g(e)},5e3):location.reload()},h=function(e){var t=(e=void 0===e?s("#backupbuddy-data-browser form").serializeObject():e).backupbuddy_restore,a=0,i=0;if(!t)return!1;s.isArray(t)||(t=new Array(t));for(var d=0;d<t.length;d++)backupbuddy_is_dir(t[d])?i++:a++;if(!a&&!i)return!1;var n="";if(i){var r=1===i?BackupBuddy.Vars.get("strings.folder"):BackupBuddy.Vars.get("strings.folders");n=i+" "+r}return a&&(n&&(n+=" & "),n+=a+" "+(r=1===a?BackupBuddy.Vars.get("strings.file"):BackupBuddy.Vars.get("strings.files"))),n},y=function(){s('a[href^="#restore-details-"]').off("click").on("click",function(e){e.preventDefault(),s(s(this).attr("href")).toggleClass("open")})},m=function(){s('#backupbuddy-data-browser form:not([data-bound="true"])').each(function(){var a=s(this);a.attr("data-bound","true"),a.on("submit",function(e){e.preventDefault();var t=s(this).serializeObject();if(!h(t))return!1;v("partial",function(){t.backupbuddy_zip=a.attr("data-zip"),t.backupbuddy_restore_type="files",t.backupbuddy_restore_tables="",s.ajax({url:BackupBuddy.Vars.get("ajax.restore"),data:t,type:"post",success:function(e){if(e.success)g(e.restore_id),s(".tab.restore-backup").addClass("processing"),s(".backupbuddy-restore-header").slideUp("fast"),s("#backupbuddy-data-browser").slideUp("fast",function(){s("#backupbuddy-data-browser").addClass("hidden"),s("#backupbuddy-restore-status").addClass("open")});else{var t=s("<p/>").addClass("error").html(e.error);BackupBuddy.Modal.open({mode:"alert",content:t})}}}),BackupBuddy.Modal.close()})})})},_=function(){s("a.restore-full-backup").off("click").on("click",function(e){e.preventDefault();function t(){var e=d||BackupBuddy.Modal.find('input[name="full-restore-type"]:checked').val();if(!e){var t=BackupBuddy.Modal.find("ul.full-restore-options"),a=BackupBuddy.Modal.find(".error");return a.length||(a=s("<p />").addClass("error"),t.before(a)),a.html(BackupBuddy.Vars.get("strings.select_restore_type_error")).show(),!1}var i="full";"db"===e?i+="_db":"files"===e&&(i+="_files"),v(i,function(){BackupBuddy.Modal.open({title:"Restoring from Backup",content:s("<p/>").css("text-align","center").html(BackupBuddy.Vars.get("strings.starting_restore"))}),s.ajax({url:BackupBuddy.Vars.get("ajax.restore"),data:{backupbuddy_zip:r,backupbuddy_restore:"*",backupbuddy_restore_tables:"*",backupbuddy_restore_destination:o,backupbuddy_restore_type:e},type:"post",success:function(e){e.success?(n=x("restore="+encodeURI(e.restore_id),n),window.location.replace(n)):e.error&&BackupBuddy.Modal.content(s("<p/>").addClass("error").css("text-align","center").html(e.error))}})})}var a=s(this),d=a.attr("data-what"),n=a.attr("href"),r=a.attr("data-zip"),o=a.attr("data-destination-id");if(d)t();else{var i=s("#backupbuddy-select-restore-type").clone();i.addClass(i.attr("id")).removeAttr("id").removeAttr("style"),i.find('input[type="radio"]:first').attr("checked","checked"),BackupBuddy.Modal.open({title:BackupBuddy.Vars.get("strings.select_restore_title"),content:i,mode:"confirm",strings:{confirm_affirmative:BackupBuddy.Vars.get("strings.continue")},callbacks:{primary:t}})}})},v=function(e,t){var a="backupbuddy-confirm-"+(e=void 0===e?"partial":e)+"-restore",i="backupbuddy-"+e+"-restore-confirm",d=s("<input />").attr("type","checkbox").attr("value","1").attr("id",a),n=[s("<div />").attr("id",i).html(BackupBuddy.Vars.get("strings.confirm_"+e+"_restore")),s("<label/>").html(BackupBuddy.Vars.get("strings.confirm_"+e+"_restore_cbx")).prepend(d)];BackupBuddy.Modal.open({title:BackupBuddy.Vars.get("strings.confirm_restore_title"),content:n,mode:"confirm",strings:{confirm_affirmative:BackupBuddy.Vars.get("strings.confirm_restore_affirmative")},callbacks:{primary:function(){if(s("#"+a).is(":checked"))return t(),!0;var e=s("#"+i).find(".error");return e.length||(e=s("<p />").addClass("error"),s("#"+i).append(e)),e.html(BackupBuddy.Vars.get("strings.confirm_restore_error")).show(),!1}}})},w=function(){s(".restore-in-progress").each(function(){var e=s(this).attr("data-restore-id");B(e)})},B=function(i){if(BackupBuddy.Restore.is_polling)return setTimeout(function(){B(i)},1e3),!1;var d=s('input[name="abort-'+i+'"]').val();BackupBuddy.Restore.is_polling=!0,s.ajax({url:BackupBuddy.Vars.get("ajax.restore_status"),data:{restore_id:i,abort:d},contentType:"application/json; charset=utf-8",dataType:"json",success:function(e){if(BackupBuddy.Restore.is_polling=!1,void 0!==e.success)if(e.overlapping)setTimeout(function(){B(i)},5e3);else if(e.success){var t=s('.restore-in-progress[data-restore-id="'+i+'"]');if("1"===d?t.html(BackupBuddy.Vars.get("strings.aborting_restore")):t.html(e.status.text),e.locked&&s('a[href="#abort-restore"][data-restore-id="'+i+'"]').fadeOut("fast"),e.is_done){var a=t.parents("td:first");a.html(e.status.text),a.next("td").html(e.status.html),s("tr#restore-details-"+i).find("td:first").html(e.status.details),y()}else setTimeout(function(){B(i)},3e3)}else{if(void 0!==e.error)return void console.log("Restore Poll Error: "+e.error);i?C(i):console.log("Restore ID is missing.")}else B(i)},statusCode:{404:function(){C(i)},500:function(){C(i)}},error:function(e,t,a){console.log(a),C(i)}}).fail(function(e,t,a){console.log(a),C(i)})},C=function(e){BackupBuddy.Restore.is_polling=!1,++t<5?setTimeout(function(){B(e)},5e3):location.reload()},x=function(e,t){var a="",i=t;return 0<=t.indexOf("#")&&(i=t.split("#")[0],a="#"+t.split("#")[1]),0<=i.indexOf("?")?i+="&"+e:i+="?"+e,i+a};return{init:function(){_(),a(),p(),m(),y(),b(),f(),w()},is_polling:!1,bind_restore_buttons:_}}(jQuery),jQuery(window).on("load",BackupBuddy.Restore.init);BackupBuddy=window.BackupBuddy||{};var checkEmailNotifyErrorStatus,pb_settings_changed=!1;BackupBuddy.Settings=function(a){"use strict";var i="backupbuddy_page_pb_backupbuddy_settings",e="."+i+" ",t=function(){a("#pb_backupbuddy_email_notify_error").length&&(""===a("#pb_backupbuddy_email_notify_error").val()?(a("#pb_backupbuddy_email_notify_error").css("background-color","#FFA1A1"),a("#emailErrorNotifyHiddenAlert").show()):(a("#pb_backupbuddy_email_notify_error").css("background-color","#FFF"),a("#emailErrorNotifyHiddenAlert").hide()))},d=function(){a(".pb_backupbuddy_customize_email_scheduled_start").on("click",function(e){e.preventDefault(),a(".pb_backupbuddy_customize_email_scheduled_start_row").slideToggle()}),a(".pb_backupbuddy_customize_send_finish").on("click",function(e){e.preventDefault(),a(".pb_backupbuddy_customize_email_send_finish_row").slideToggle()}),a(".pb_backupbuddy_customize_email_scheduled_complete").on("click",function(e){e.preventDefault(),a(".pb_backupbuddy_customize_email_scheduled_complete_row").slideToggle()}),a(".pb_backupbuddy_customize_email_error").on("click",function(e){e.preventDefault(),a(".pb_backupbuddy_customize_email_error_row").slideToggle()})},n=function(){a("#pb_backupbuddy_email_error_test").on("click",function(){return a.post(BackupBuddy.Vars.get("ajax.email_error_test"),{email:a("#pb_backupbuddy_email_notify_error").val()},function(e){"1"!=(e=a.trim(e)).charAt(0)?alert(BackupBuddy.Vars.get("strings.error_testing")+":\n\n"+e):alert(BackupBuddy.Vars.get("strings.email_test_sent")+"\n\n"+e.slice(1))}),!1})},r=function(){a(document).on("backupbuddy.tabs.switch",function(e,t){a("body").hasClass(i)&&"#advanced"===t&&a(".nav-tab-2").trigger("click")})},o=function(){a("#pb_backupbuddy_email_notify_error").on("change",function(){t()})},s=function(){a(e+".backupbuddy-tabs .tab-controls a").on("click",function(e){!0===pb_settings_changed&&(alert("You have made changes without saving! Be sure to save your changes!"),pb_settings_changed=!1)}),a(e+".pb_form").on("change",function(){pb_settings_changed=!0})};return{init:function(){d(),n(),r(),t(),o(),s()}}}(jQuery),jQuery(window).on("load",BackupBuddy.Settings.init),(BackupBuddy=window.BackupBuddy||{}).Tabs=function(i){"use strict";var e=function(){if(i(".backupbuddy-tabs").length){i(".backupbuddy-tabs .tab-controls a").on("click",function(e){e.preventDefault();var t=i(this).attr("href");"#"===t.charAt(0)?a(t):window.location.replace(t)});var e=window.location.hash;e&&a(e)}},a=function(e){var t=i('.backupbuddy-tabs .tab-controls a[href$="'+e+'"]').parent("li"),a=i(e);t.length&&a.length&&(i(".backupbuddy-tabs .tab-controls .active").removeClass("active"),t.addClass("active"),i(".backupbuddy-tabs .tab-contents.active").removeClass("active"),a.addClass("active"),i(document).trigger("backupbuddy.tabs.switch",e),history.pushState?history.pushState(null,null,e):window.location.hash=e)};return{init:function(){e()}}}(jQuery),jQuery(window).on("load",BackupBuddy.Tabs.init),(BackupBuddy=window.BackupBuddy||{}).Vars=function(){"use strict";var d=function(e){return void 0!==backupbuddy_vars.ajax_base&&backupbuddy_vars.ajax_base+e};return{get:function(e){if("undefined"==typeof backupbuddy_vars)return!1;for(var t=e,a=backupbuddy_vars,i=!1;0<=t.indexOf(".");){i=t.split(".")[0];t=e.replace(i+".",""),void 0!==a[i]&&(a=a[i])}return void 0===a[t]?"ajax"===i&&d(t):a[t]},get_ajax_url:d}}(jQuery);