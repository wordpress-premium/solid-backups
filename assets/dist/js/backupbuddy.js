function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}var pb_backupbuddy_selectdestination;!function(e,t,a){if("onprogress"in e.ajaxSettings.xhr()){var n=e.ajaxSettings.xhr;e.ajaxSettings.xhr=function(){var e=n.apply(this,arguments);return e instanceof t.XMLHttpRequest&&e.addEventListener("progress",this.progress,!1),e.upload&&e.upload.addEventListener("progress",this.progress,!1),e}}}(jQuery,window),function(e,t,a){"use strict";var n="stickyTableHeaders",i=0,d={fixedOffset:0,leftOffset:0,marginTop:0,objDocument:document,objHead:"head",objWindow:t,scrollableArea:t,cacheHeaderHeight:!1,zIndex:3};e.fn[n]=function(a){return this.each((function(){var r=e.data(this,"plugin_"+n);r?"string"==typeof a?r[a].apply(r):r.updateOptions(a):"destroy"!==a&&e.data(this,"plugin_"+n,new function(a,r){var o=this;o.$el=e(a),o.el=a,o.id=i++,o.$el.bind("destroyed",e.proxy(o.teardown,o)),o.$clonedHeader=null,o.$originalHeader=null,o.cachedHeaderHeight=null,o.isSticky=!1,o.hasBeenSticky=!1,o.leftOffset=null,o.topOffset=null,o.init=function(){o.setOptions(r),o.$el.each((function(){var t=e(this);t.css("padding",0),o.$originalHeader=e("thead:first",this),o.$clonedHeader=o.$originalHeader.clone(),t.trigger("clonedHeader."+n,[o.$clonedHeader]),o.$clonedHeader.addClass("tableFloatingHeader"),o.$clonedHeader.css({display:"none",opacity:0}),o.$originalHeader.addClass("tableFloatingHeaderOriginal"),o.$originalHeader.after(o.$clonedHeader),o.$printStyle=e('<style type="text/css" media="print">.tableFloatingHeader{display:none !important;}.tableFloatingHeaderOriginal{position:static !important;}</style>'),o.$head.append(o.$printStyle)})),o.$clonedHeader.find("input, select").attr("disabled",!0),o.updateWidth(),o.toggleHeaders(),o.bind()},o.destroy=function(){o.$el.unbind("destroyed",o.teardown),o.teardown()},o.teardown=function(){o.isSticky&&o.$originalHeader.css("position","static"),e.removeData(o.el,"plugin_"+n),o.unbind(),o.$clonedHeader.remove(),o.$originalHeader.removeClass("tableFloatingHeaderOriginal"),o.$originalHeader.css("visibility","visible"),o.$printStyle.remove(),o.el=null,o.$el=null},o.bind=function(){o.$scrollableArea.on("scroll."+n,o.toggleHeaders),o.isWindowScrolling||(o.$window.on("scroll."+n+o.id,o.setPositionValues),o.$window.on("resize."+n+o.id,o.toggleHeaders)),o.$scrollableArea.on("resize."+n,o.toggleHeaders),o.$scrollableArea.on("resize."+n,o.updateWidth)},o.unbind=function(){o.$scrollableArea.off("."+n,o.toggleHeaders),o.isWindowScrolling||(o.$window.off("."+n+o.id,o.setPositionValues),o.$window.off("."+n+o.id,o.toggleHeaders)),o.$scrollableArea.off("."+n,o.updateWidth)},o.debounce=function(e,t){var a=null;return function(){var n=this,i=arguments;clearTimeout(a),a=setTimeout((function(){e.apply(n,i)}),t)}},o.toggleHeaders=o.debounce((function(){o.$el&&o.$el.each((function(){var t,a,i,d=e(this),r=o.isWindowScrolling?isNaN(o.options.fixedOffset)?o.options.fixedOffset.outerHeight():o.options.fixedOffset:o.$scrollableArea.offset().top+(isNaN(o.options.fixedOffset)?0:o.options.fixedOffset),s=d.offset(),u=o.$scrollableArea.scrollTop()+r,c=o.$scrollableArea.scrollLeft(),l=o.isWindowScrolling?u>s.top:r>s.top;l&&(a=o.options.cacheHeaderHeight?o.cachedHeaderHeight:o.$clonedHeader.height(),i=(o.isWindowScrolling?u:0)<s.top+d.height()-a-(o.isWindowScrolling?0:r)),l&&i?(t=s.left-c+o.options.leftOffset,o.$originalHeader.css({position:"fixed","margin-top":o.options.marginTop,top:0,left:t,"z-index":o.options.zIndex}),o.leftOffset=t,o.topOffset=r,o.$clonedHeader.css("display",""),o.isSticky||(o.isSticky=!0,o.updateWidth(),d.trigger("enabledStickiness."+n)),o.setPositionValues()):o.isSticky&&(o.$originalHeader.css("position","static"),o.$clonedHeader.css("display","none"),o.isSticky=!1,o.resetWidth(e("td,th",o.$clonedHeader),e("td,th",o.$originalHeader)),d.trigger("disabledStickiness."+n))}))}),0),o.setPositionValues=o.debounce((function(){var e=o.$window.scrollTop(),t=o.$window.scrollLeft();!o.isSticky||e<0||e+o.$window.height()>o.$document.height()||t<0||t+o.$window.width()>o.$document.width()||o.$originalHeader.css({top:o.topOffset-(o.isWindowScrolling?0:e),left:o.leftOffset-(o.isWindowScrolling?0:t)})}),0),o.updateWidth=o.debounce((function(){if(o.isSticky){o.$originalHeaderCells||(o.$originalHeaderCells=e("th,td",o.$originalHeader)),o.$clonedHeaderCells||(o.$clonedHeaderCells=e("th,td",o.$clonedHeader));var t=o.getWidth(o.$clonedHeaderCells);o.setWidth(t,o.$clonedHeaderCells,o.$originalHeaderCells),o.$originalHeader.css("width",o.$clonedHeader.width()),o.options.cacheHeaderHeight&&(o.cachedHeaderHeight=o.$clonedHeader.height())}}),0),o.getWidth=function(a){var n=[];return a.each((function(a){var i,d=e(this);if("border-box"===d.css("box-sizing")){var r=d[0].getBoundingClientRect();i=r.width?r.width:r.right-r.left}else if("collapse"===e("th",o.$originalHeader).css("border-collapse"))if(t.getComputedStyle)i=parseFloat(t.getComputedStyle(this,null).width);else{var s=parseFloat(d.css("padding-left")),u=parseFloat(d.css("padding-right")),c=parseFloat(d.css("border-width"));i=d.outerWidth()-s-u-c}else i=d.width();n[a]=i})),n},o.setWidth=function(e,t,a){t.each((function(t){var n=e[t];a.eq(t).css({"min-width":n,"max-width":n})}))},o.resetWidth=function(t,a){t.each((function(t){var n=e(this);a.eq(t).css({"min-width":n.css("min-width"),"max-width":n.css("max-width")})}))},o.setOptions=function(t){o.options=e.extend({},d,t),o.$window=e(o.options.objWindow),o.$head=e(o.options.objHead),o.$document=e(o.options.objDocument),o.$scrollableArea=e(o.options.scrollableArea),o.isWindowScrolling=o.$scrollableArea[0]===o.$window[0]},o.updateOptions=function(e){o.setOptions(e),o.unbind(),o.bind(),o.updateWidth(),o.toggleHeaders()},o.init()}(this,a))}))}}(jQuery,window),(BackupBuddy=window.BackupBuddy||{}).Backups=function(e){"use strict";var t=function(){e(".pb_backupbuddy_hoveraction_send").on("click",(function(t){return t.preventDefault(),tb_show("Solid Backups",BackupBuddy.Vars.get("ajax.destination_picker")+"&callback_data="+e(this).attr("rel")+"&sending=1&action_verb=to%20send%20to&TB_iframe=1&width=640&height=455",null),!1})),e("a.remote-send").off("click").on("click",(function(t){t.preventDefault();var a=e(this).attr("data-backup-zip");return tb_show("Solid Backups",BackupBuddy.Vars.get("ajax.destination_picker")+"&callback_data="+a+"&sending=1&action_verb=to%20send%20to&TB_iframe=1&width=640&height=455",null),!1}))},a=function(){e(".backup-actions").off("click").on("click",(function(t){t.preventDefault(),e(".backup-actions-menu.open").removeClass("open"),e(".backup-actions.active").not(e(this)).removeClass("active"),e(this).hasClass("active")?(e(this).removeClass("active"),e(this).blur()):(e(this).addClass("active"),e(this).next(".backup-actions-menu").addClass("open"))})),e(document).on("mouseup",(function(t){if(e(t.target).hasClass("backup-actions"))return!0;e(".backup-actions-menu").removeClass("open"),e(".backup-actions.active").removeClass("active"),e(".backup-actions").blur()}))},n=function(){e(".pb_backupbuddy_hoveraction_hash").on("click",(function(t){return t.preventDefault(),tb_show("Solid Backups",BackupBuddy.Vars.get("ajax.hash")+"&callback_data="+e(this).attr("rel")+"&TB_iframe=1&width=640&height=455",null),!1}))},i=function(){e(".pb_backupbuddy_hoveraction_note").on("click",(function(t){t.preventDefault();var a=e(this).parents("td").find(".pb_backupbuddy_notetext").text();return""==a&&(a="My first backup"),BackupBuddy.Modal.open({mode:"prompt",title:"Backup Note",content:BackupBuddy.Vars.get("strings.note_instructions"),prompt_default:a,prompt:function(t){if(null==t||""==t)return!1;e(".pb_backupbuddy_backuplist_loading").show(),e.post(BackupBuddy.Vars.get("ajax.set_backup_note"),{backup_file:e(this).attr("rel"),note:t},(function(t){t=e.trim(t),e(".pb_backupbuddy_backuplist_loading").hide(),"1"!=t&&BackupBuddy.Modal.open({mode:"alert",content:BackupBuddy.Vars.get("strings.error")+": "+t}),location.reload(!0)}))}}),!1}))},d=function(){e(".profile_item_cancel_add_select").off("click").on("click",(function(t){t.preventDefault(),e("#pb_backupbuddy_profileadd").hide(),e("#pb_backupbuddy_profileadd_plusbutton").show()}))},r=function(){e('a[href$="#backup-details"]').off("click").on("click",(function(t){t.preventDefault();var a=e("<span />").addClass("spinner").css("float","none").css("visibility","visible").css("margin-top","-1px"),n=e("<div />").addClass("backupbuddy-backup-details loading").append(a).append("Loading..."),i=e(this).attr("data-backup-zip"),d=e(this).attr("data-destination-id");BackupBuddy.Modal.open({title:"Backup Details",content:n}),e.ajax({url:BackupBuddy.Vars.get("ajax.backup_info"),data:{backup:i,destination:d,return:"html"},success:function(e){if(n.removeClass("loading"),e.success)n.html(e.html);else{var t=void 0===e.error?"Could not retrieve backup detail.":e.error;n.addClass("failed").html(t)}}})}))},o=function(){var t=e(".backupbuddy-tabs .restore-backup");if(t.length&&!e("#backupbuddy-data-browser").length&&!e("#backupbuddy-restore-status").hasClass("open")){var a=BackupBuddy.Vars.get("destination_ids");if(a.length&&!t.data("remote-loaded")){t.data("remote-loaded",!0);for(var n=[],i=0;i<a.length;i++)n[i]=!0;var d=[];e(".restore-backups-table tbody tr:not(.hidden)").each((function(){d[d.length]=e(this).attr("data-id")})),s(n);for(var o=0;o<a.length;o++)e.ajax({url:BackupBuddy.Vars.get("ajax.remote_backups"),data:{mode:"restore",destination_id:a[o],index:o},success:function(t){if(t.success&&t.backups.length){var a,i=!!e(".restore-backups-table table").length;for(a=0;a<t.backups.length;a++)if(!1!==i||void 0===t.backups[a].restore){e(t.backups[a].restore).find("tbody tr").each((function(){var t=e(this),a=t.data("id");if(e.inArray(a,d)>=0)t.addClass("hidden");else{d[d.length]=a;var n=parseInt(t.attr("data-timestamp")),i=e(".restore-backups-table tbody tr").filter((function(){return parseInt(e(this).attr("data-timestamp"))<=n})).first();i.length?i.before(t):e(".restore-backups-table tbody").append(t)}}))}else{var o=e(".restore-backups-table");o.length||(o=e("<div />").addClass("restore-backups-table"),e("#backupbuddy-restore-status").length?e("#backupbuddy-restore-status").after(o):e("#restore-backup").prepend(o)),e("#restore-backup .no-backups-created").remove(),o.html(t.backups[a].restore),i=!0}r(),BackupBuddy.Restore.bind_restore_buttons()}e("#restore-backup th.stash-traditional-backup-files").length&&e("#restore-backup th.stash-traditional-backup-files:first").html(e("#restore-backup th.stash-traditional-backup-files:first").html().replace(BackupBuddy.Vars.get("strings.stash_table_header"),BackupBuddy.Vars.get("strings.backups_table_header"))),n[t.index]=!1,s(n),c()}})}}},s=function(t){for(var a=!1,n=e(".backupbuddy-tabs .restore-backup"),i=0;i<t.length;i++)if(t[i]){a=!0;break}a?n.length&&n.addClass("processing"):n.removeClass("processing")},u=function(){var t=e(".backupbuddy-generate-dat");if(t.length){var a=t.data("zip");a&&e.ajax({url:BackupBuddy.Vars.get("ajax.create-dat"),data:{zip_file:a},success:function(n){if(n.success){var i=BackupBuddy.Vars.get("page_url");i+="&dat_viewer="+encodeURI(a),i+="&value="+encodeURI(a),window.location.href=i}else t.hide(),e(".legacy-file-restore-wrapper").show(),backupbuddy_legacy_file_browser()}})}},c=function(){for(var t=["#backups-main table.minimal",".restore-backups-table",".bb-iframe-divpadding-noscroll table.minimal"],a=0;a<t.length;a++){e(t[a]+" .separator").removeClass("separator"),e(t[a]+" .begin-month").removeClass("begin-month");var n="",i=0;e(t[a]+" tbody tr").each((function(t){var a=e(this).attr("class").split(" ").filter((function(e){return e.indexOf("month-")>-1}));a[0]!==n?(n=a[0],i=0,0!==t&&e(this).addClass("begin-month")):i++,5===i&&(i=0,e(this).addClass("separator"))}))}};return pb_backupbuddy_selectdestination=function(t,a,n,i,d){if(""!=n&&"delayed_send"!=n){if("importbuddy.php"===n){var r=e('<div id="pb_backupbuddy_ib_sent" class="pb_backupbuddy_alert updated fade">'+BackupBuddy.Vars.get("strings.sending_importbuddy")+"</div>");return e("h1:first").after(r),e.ajax({url:BackupBuddy.Vars.get("ajax.send_importbuddy"),data:{destination_id:t,destination_title:a,callback_data:n},success:function(t){(r=e("#pb_backupbuddy_ib_sent")).html(t.notice),t.success||r.removeClass("updated").addClass("error")}}),!1}e.post(BackupBuddy.Vars.get("ajax.remote_send"),{destination_id:t,destination_title:a,file:n,trigger:"manual",delete_after:i},(function(t){if("1"!=(t=e.trim(t)).charAt(0))BackupBuddy.Modal.open({mode:"alert",content:BackupBuddy.Vars.get("strings.remote_send_error")+":\n\n"+t});else{var a=" "+BackupBuddy.Vars.get("strings.local_delete_upon_success");i||(a=""),BackupBuddy.Modal.open({mode:"alert",title:"Backup Send Scheduled",content:BackupBuddy.Vars.get("strings.remote_send_confirmed")+a+"\n\n"+t.slice(1)}),e.post(BackupBuddy.Vars.get("ajax_base"))}}))}else"delayed_send"==n?(e("#pb_backupbuddy_backup_remotedestination").val(t),e("#pb_backupbuddy_backup_deleteafter").val(i),e("#pb_backupbuddy_backup_remotetitle").html('Destination: "'+a+'".')):window.location.href=BackupBuddy.Vars.get("admin_url")+"?page=pb_backupbuddy_backup&custom=remoteclient&destination_id="+t},{init:function(){t(),n(),i(),d(),r(),a(),o(),u(),c()},cleanup:function(t,a){e.ajax({url:BackupBuddy.Vars.get("ajax.cleanup"),data:{rel:t},success:function(t){t.success?e('div[rel="'+a+'"]').fadeOut("fast",(function(){e(this).remove()})):e('div[rel="'+a+'"] .button-actions').addClass("error").html(t.error)}})}}}(jQuery),jQuery(window).on("load",BackupBuddy.Backups.init);var BackupBuddy=window.BackupBuddy||{},MutationObserver=window.MutationObserver||window.WebKitMutationObserver;BackupBuddy.Core=function(e){"use strict";var t=function(){BackupBuddy.Vars.get("hide_quick_setup")||e("#screen-meta-links").append('<div class="backupbuddy-meta-link-wrap hide-if-no-js screen-meta-toggle"><a href="?page=pb_backupbuddy_backup&wizard=1" class="show-settings no-dropdown">'+BackupBuddy.Vars.get("strings.quick_setup")+"</a></div>")},a=function(){var t=e("<a />").attr("href","#importbuddy").addClass("show-settings").text(BackupBuddy.Vars.get("strings.importbuddy")),a=e("<div/>").addClass("backupbuddy-meta-link-wrap hide-if-no-js screen-meta-toggle"),n=e("<div />").addClass("hover-menu-inner"),i=e("<div />").addClass("hover-menu"),d=e("<a />").addClass("download-importbuddy").attr("href",BackupBuddy.Vars.get("ajax.importbuddy")).text(BackupBuddy.Vars.get("strings.importbuddy_download")),r=e("<a />").addClass("send-importbuddy").attr("href",BackupBuddy.Vars.get("ajax.destination_picker")).text(BackupBuddy.Vars.get("strings.importbuddy_send")).attr("rel","importbuddy.php");i.append(n),t.on("click",(function(e){e.preventDefault()})),d.on("click",(function(t){t.preventDefault();var a=e(this).attr("href");return BackupBuddy.Vars.get("importbuddy_pass_set")?(BackupBuddy.Modal.open({mode:"prompt",title:"Create Importer Password",content:"<p>"+BackupBuddy.Vars.get("strings.importbuddy_prompt_haspass")+"</p>",prompt:function(e){var t=a;null!=e&&""!=e&&(t+="&p="+encodeURIComponent(e)),window.location.href=t}}),!1):(BackupBuddy.Modal.open({mode:"prompt",title:"Create Importer Password",content:"<p>"+BackupBuddy.Vars.get("strings.importbuddy_prompt_nopass")+"</p>",prompt:function(e){null==e||""==e?""==e&&BackupBuddy.Modal.open({mode:"alert",content:BackupBuddy.Vars.get("strings.importbuddy_no_password")}):window.location.href=a+"&p="+encodeURIComponent(e)}}),!1)})),r.on("click",(function(t){if(t.preventDefault(),!BackupBuddy.Vars.get("importbuddy_pass_set"))return BackupBuddy.Modal.open({mode:"alert",content:"You must set an Importer password via the Solid Backups settings page before you can send this file."}),!1;var a=e(this).attr("href"),n=e(this).attr("rel");return n&&("importbuddy.php"!==n&&(a+="&action_verb=to%20send%20to"),a+="&callback_data="+n),a+="&sending=1&TB_iframe=1&width=640&height=455",tb_show("Solid Backups",a,null),!1})),n.append(d).append(r),t.append(i),a.append(t),e("#screen-meta-links").append(a)};return{init:function(){e("body").hasClass("toplevel_page_pb_backupbuddy_backup")&&(t(),a())}}}(jQuery),jQuery(window).on("load",BackupBuddy.Core.init);BackupBuddy=window.BackupBuddy||{},MutationObserver=window.MutationObserver||window.WebKitMutationObserver;BackupBuddy.Destinations=function(e){"use strict";var t=0,a=0,n=function(){i(),d()},i=function(){var t=new MutationObserver(r),a=e("#pb_backupbuddy_iframe-dest-wrap").first(),n=e("body.destination-tabs"),i=e(".bb-iframe-divpadding-noscroll");if(a.length||n.length||i.length){var d=a.length?a[0]:n.length?n[0]:i[0],o={childList:!0,subtree:!0};i.length&&(o.attributes=!0),r(),t.observe(d,o)}},d=function(){var t=new MutationObserver(o),a=e(".tab-contents.active iframe.backupbuddy-destination-iframe").first(),n=e("body.backupbuddy-admin-iframe");if(a.length||n.length){var i=a.length?a[0]:n[0];o(),t.observe(i,{childList:!0,subtree:!0})}},r=function(){var a=!1;if(a=e("#pb_backupbuddy_iframe-dest-wrap").length?e("#pb_backupbuddy_iframe-dest-wrap")[0]:window.parent.document.getElementById("pb_backupbuddy_iframe-dest-wrap")){a.removeAttribute("style");var n=a.contentWindow.document.documentElement.scrollHeight;e(".bb-iframe-divpadding-noscroll").length&&(n+=50),a.style.height=n+"px",t!==n&&(t=n)}},o=function(){var t=!1;if(t=e(".tab-contents.active iframe.backupbuddy-destination-iframe").length?e(".tab-contents.active iframe.backupbuddy-destination-iframe").first()[0]:window.parent.document.getElementById("pb_backupbuddy_iframe-dest-wrap")){t.removeAttribute("style");var n=t.contentWindow.document.documentElement.scrollHeight;n+=50,t.style.height=n+"px",a!==n&&(a=n)}};return{init:function(){n(),e(window).on("backupbuddy.tabs.switch",(function(){r(),o()}))},tabsIframeLoad:function(){e(".backupbuddy_destinations_iframe_load").fadeOut("fast"),r()},resizeDestIframe:o}}(jQuery),jQuery(window).on("load",BackupBuddy.Destinations.init),(BackupBuddy=window.BackupBuddy||{}).Diagnostics=function(e){"use strict";var t="backupbuddy_page_pb_backupbuddy_diagnostics",a=function(){e('.backups_page_pb_backupbuddy_diagnostics a[href="#extraneous-log"]').off("click").on("click",(function(t){t.preventDefault(),e("#backupbuddy-extra-log").slideToggle("fast"),e("#backupbuddy_logFile").attr("data-loaded")||i()})),e('.backups_page_pb_backupbuddy_diagnostics a[href="#remoteapi-log"]').off("click").on("click",(function(t){t.preventDefault(),e("#backupbuddy-remoteapi-log").slideToggle("fast"),e("#backupbuddy_remoteapi_logFile").attr("data-loaded")||d()})),e('.backups_page_pb_backupbuddy_diagnostics a[href="#hide"]').off("click").on("click",(function(t){t.preventDefault();var a=e(this).data("log");"main"===a?e("#backupbuddy-extra-log").slideToggle("fast"):"remote"===a&&e("#backupbuddy-remoteapi-log").slideToggle("fast")}))},n=function(){e(document).on("backupbuddy.tabs.switch",(function(a,n){e("body").hasClass(t)}))},i=function t(a){a=void 0===a?0:a,e("#backupbuddy_logFile").length&&e.post(BackupBuddy.Vars.get("ajax.getMainLog"),{confirmed:a},(function(a){"string"!=typeof a?confirm("WARNING: Log file is very large ("+a.size+"). This could take a while to load. Are you sure you want to continue?")?t(1):e("#backupbuddy-extra-log").slideToggle("fast"):e("#backupbuddy_logFile").text(a).attr("data-loaded","true")}))},d=function t(a){a=void 0===a?0:a,e("#backupbuddy_remoteapi_logFile").length&&e.post(BackupBuddy.Vars.get("ajax.getRemoteApiLog"),{confirmed:a},(function(a){"string"!=typeof a?confirm("WARNING: Log file is very large ("+a.size+"). This could take a while to load. Are you sure you want to continue?")?t(1):e("#backupbuddy-remoteapi-log").slideToggle("fast"):e("#backupbuddy_remoteapi_logFile").text(a).attr("data-loaded","true")}))},r=function(){e('a[href="#reset-log"]').off("click").on("click",(function(t){if(t.preventDefault(),!confirm("Are you sure you want to reset this log?"))return!1;var a=e(this).data("log");!function(t,a,n){e.post(BackupBuddy.Vars.get("ajax.reset_log"),{log:t},(function(e){e.success&&a?a():(e.error&&BackupBuddy.Modal.open({mode:"alert",content:e.error}),n&&n())}))}(a,(function(){e('textarea[data-log-file="'+a+'"]').text("-- Log Reset --"),"main"===a?e("#backupbuddy_logFile").removeAttr("data-loaded"):"remote"===a&&e("#backupbuddy_remoteapi_logFile").removeAttr("data-loaded")}))}))};return{init:function(){a(),n(),r()},load_logs:function(){i(),d()}}}(jQuery),jQuery(window).on("load",BackupBuddy.Diagnostics.init),(BackupBuddy=window.BackupBuddy||{}).File_Viewer=function(e){"use strict";var t=function(){e(document).on("backupbuddy.modal.close",(function(){e(".backupbuddy-file-viewer .CodeMirror").remove(),e(".backupbuddy-file-viewer .file-contents").remove(),e(".backupbuddy-file-viewer .file-preview").remove()}))},a=function(){e("a.view-file").off("click").on("click",(function(t){t.preventDefault();var a=e(this);!function(t,a,n,i){var d=e("<div />").addClass("backupbuddy-file-viewer").addClass("mode-"+n);if("code"===n){var r=e("<textarea />").addClass("file-contents loading").val("Loading...").attr("readonly","readonly");d.append(r),r=d.find(".file-contents")}else r=e("<div />").addClass("file-preview loading").html("Loading..."),d.append(r),r=d.find(".file-preview");BackupBuddy.Modal.open({content:d,title:a}),e.ajax({url:BackupBuddy.Vars.get("ajax.get_file"),data:{backup:t,path:a,mode:n,type:i},success:function(t){if(void 0!==t.warning&&(e("<div />").addClass("warning").html(t.warning),console.log(t.warning)),t.success)if(r.removeClass("loading"),"code"===n){r.val(t.contents),BackupBuddy.Modal.set_size("max");var a=wp.codeEditor.defaultSettings?_.clone(wp.codeEditor.defaultSettings):{};a.codemirror=_.extend({},a.codemirror,{indentUnit:1,tabSize:4,mode:t.mode,indentWithTabs:!0,readOnly:!0}),wp.codeEditor.initialize(r,a)}else BackupBuddy.Modal.content(t.contents);else void 0!==t.error&&(e("<div />").addClass("error").html(t.error),console.log(t.error),d.hide())}})}(e("#backupbuddy-data-browser form").attr("data-zip"),a.attr("data-path"),a.attr("data-mode"),a.attr("data-type"))}))};return{init:function(){a(),t()}}}(jQuery),jQuery(window).on("load",BackupBuddy.File_Viewer.init),(BackupBuddy=window.BackupBuddy||{}).FileTree=function(e){"use strict";var t=function(t){var a=e("<span/>").addClass("spinner");t.append(a)},a=function(e){return e.find(".spinner").length},n=function(e){e.find(".spinner").remove()},i=function(t){var a=t.attr("href").replace("#","");t.toggleClass("open"),t.hasClass("open")?e('tr[data-parent-id="'+a+'"].hidden').removeClass("hidden"):(e('tr[data-parent-id^="'+a+'"]:not(.hidden)').addClass("hidden"),e('tr[data-parent-id^="'+a+'"] a.folder-toggle.open').removeClass("open"))},d=function(e,t){e.toggleClass("open"),t.toggleClass("expanded"),t.find("ul:first").toggleClass("open")},r=function(t){return e('.panel[data-path="'+t+'"]').length},o=function(t,a){a=void 0===a?250:a,setTimeout((function(){e(".backupbuddy-file-tree").css("height",t.outerHeight(!0))}),a)},s=function(t,a){var n=e('.panel[data-path="'+t+'"]'),i=e(".panel.active");if(a=void 0===a?"forward":"back",n.length&&i.length){n.addClass("instant");"forward"===a?setTimeout((function(){n.removeClass("inactive").addClass("next"),setTimeout((function(){n.removeClass("instant"),setTimeout((function(){i.addClass("inactive").removeClass("active"),n.addClass("active").removeClass("next")}),5)}),5)}),5):setTimeout((function(){n.removeClass("next").addClass("inactive"),setTimeout((function(){n.removeClass("instant"),setTimeout((function(){i.addClass("next").removeClass("active"),n.addClass("active").removeClass("inactive")}),5)}),5)}),5),o(n,265)}},u=function(){e('.backupbuddy-file-tree a.folder-toggle:not([data-bound="true"])').each((function(){var o=e(this),u=e(".backupbuddy-file-tree table").length?"table":"list";o.attr("data-bound","true"),o.on("click",(function(l){if(l.preventDefault(),!o.hasClass("disabled")){var p=o.attr("href").replace("#","");if(r(p))s(p);else if("list"===u){var b=o.parents("li:first"),f=o.parent("div");if(a(f))return;b.find("ul:first").length?d(o,b):(t(f),c(b.attr("data-dir"),f,(function(){d(o,b),n(f)})))}else{if(a(o))return;if(e('tr[data-parent-id="'+p+'"]').length)i(o);else{var k=o.parents("tr:first");t(o),c(k.attr("data-dir"),k,(function(){i(o),n(o)}))}}}}))}))},c=function(t,a,n){var i=e("#backupbuddy-file-tree"),d=e("#backupbuddy-data-browser > form"),c=!!d.attr("data-zip")&&d.attr("data-zip"),l=!!d.attr("data-serial")&&d.attr("data-serial"),p=e('input[name="backupbuddy_restore_destination"]').val(),b=i.hasClass("panels"),f=void 0===a?"inside":"after";c&&l&&(t=void 0===t?"__root__":t,a=void 0===a?i:a,b&&(f="append",a=i),e.ajax({url:BackupBuddy.Vars.get("ajax.file_tree"),data:{dat_viewer:c,path:t,serial:l,destination:p},success:function(t){if("inside"===f)a.html(t);else if("after"===f)a.after(t);else if("append"===f){var i=".panel.incoming",d=240;a.hasClass("loading")&&(a.html(""),i=".panel",d=10),a.find(".panel.active").addClass("inactive").removeClass("active"),a.append(t);var c=a.find(i);setTimeout((function(){c.addClass("active").removeClass("incoming")}),5),o(c,d)}a.removeClass("loading"),u(),e('.backupbuddy-file-tree a.breadcrumb:not([data-bound="true"])').each((function(){var t=e(this);t.attr("data-bound","true"),t.on("click",(function(e){if(e.preventDefault(),!t.hasClass("disabled")){var a=t.attr("href").replace("#","");r(a)&&s(a,"back")}}))})),1===e("ul#tree_root > li").length?e("ul#tree_root > li > a.folder-toggle").trigger("click"):1===e("table#tree_root tbody tr").length&&e("table#tree_root tbody tr a.folder-toggle").trigger("click"),e('.backupbuddy-file-tree input[type="checkbox"]:not([data-toggler-bound="true"])').each((function(){var t=e(this),a=e(".backupbuddy-file-tree > table").length?"table":"list";t.attr("data-toggler-bound","true"),t.on("change",(function(){if("list"===a)t.parents("li:first").find('ul:first input[type="checkbox"]'),t.parents("li:first").parent("ul").parent("li").find('input[type="checkbox"]:first');else{var n=t.parents("tr:first"),i=n.attr("id")?n.attr("id").replace("dir_",""):"",d=(!!i&&e('tr[data-parent-id^="'+i+'"] input[type="checkbox"]'),n.attr("data-parent-id"));e("#dir_"+d).find('input[type="checkbox"]:first')}}))})),setTimeout(BackupBuddy.FileTree.sticky_headers,500),BackupBuddy.Restore.init(),BackupBuddy.File_Viewer.init(),"function"==typeof n&&n()}}))},l=function(){var t=e("#backupbuddy-data-browser > form"),a=t.attr("data-zip")?t.attr("data-zip"):BackupBuddy.Vars.get("backup_zip");a&&e.ajax({url:BackupBuddy.Vars.get("ajax.backup_info"),data:{backup:a,serial:BackupBuddy.Vars.get("backup_serial")},success:function(t){var a=e(".backup-size"),n=e(".backup-wp-version");t.success&&(void 0!==t.info.size&&a.hide().html(t.info.size).fadeIn("fast"),void 0!==t.info.wp_version&&n.hide().html(BackupBuddy.Vars.get("strings.wp_version")+" "+t.info.wp_version).fadeIn("fast"))}})};return{init:function(){c(),l()},sticky_headers:function(){var t=!1,a=!1,n=e("#backupbuddy-file-tree.panels").length;if(e(d=n?"#backupbuddy-file-tree .panel.active table":"#backupbuddy-file-tree table").length){n&&e("#backupbuddy-file-tree table").stickyTableHeaders("destroy"),e(d).stickyTableHeaders({fixedOffset:e("#wpadminbar")});var i=e(".tableFloatingHeaderOriginal")}else{var d;i=e(d=n?".panel.active .list-header":".list-header");t=i.width(),a=i.outerHeight()}if(i.length&&!i.attr("data-is-sticky")){i.attr("data-is-sticky",!0);var r=i.offset().top-e("#wpadminbar").outerHeight(),o=e("#backupbuddy-data-browser");e(window).on("scroll",(function(){var n=e(window).scrollTop();r<n&&o.height()+o.offset().top-i.height()>n?(i.addClass("stuck"),t&&i.css("width",t),a&&o.css("padding-top",a)):(i.removeClass("stuck").removeAttr("style"),o.removeAttr("style"),t&&(t=i.width()),a&&(a=i.outerHeight()))}))}}}}(jQuery),jQuery(window).on("load",BackupBuddy.FileTree.init),function(e){"use strict";e.fn.serializeObject=function(){var t=this.serializeArray(),a={},n=[];return e.each(t,(function(){var e;e=null!=this.value?this.value:"",this.name.indexOf("[]")>=0&&(this.name=this.name.replace("[]",""),n.push(this.name)),null!=a[this.name]&&n.includes(this.name)?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(e)):a[this.name]=e})),a}}(jQuery);var pb_backupbuddy_profile_updated,backupbuddy_is_dir=function(e){return"/"===e.substr(e.length-1)},backupbuddy_trim_slashes=function(e){return e.replace(/^\/+|\/+$/g,"")},backupbuddy_basename=function(e,t){t=void 0!==t&&t;var a=new String(e);return a=(a=backupbuddy_trim_slashes(a)).substring(a.lastIndexOf("/")+1),t&&-1!=a.lastIndexOf(".")&&(a=a.substring(0,a.lastIndexOf("."))),a},backupbuddy_autoscroll=function(e){e.scrollTop(e[0].scrollHeight)},backupbuddy_oauth_window=function(e,t,a,n){var i=null!=window.screenLeft?window.screenLeft:window.screenX,d=null!=window.screenTop?window.screenTop:window.screenY,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=r/window.screen.availWidth,u=(r-a)/2/s+i,c=(o-n)/2/s+d,l=window.open(e,t,"scrollbars=no, width="+a/s+", height="+n/s+", top="+c+", left="+u);return window.focus&&l.focus(),l};(BackupBuddy=window.BackupBuddy||{}).Modal=function(e){"use strict";var t=!1,a={},n={content:"",theme:"",mode:"",title:"",size:{},strings:{alert_button:"OK",confirm_affirmative:"OK",confirm_negative:"Cancel",prompt_button:"OK"},callbacks:{primary:function(){return k(),!0},secondary:function(){return k(),!1}},prompt:function(){return!1},prompt_default:!1,close_on_background_click:!0,close_with_esc_key:!0,disable_close_button:!1,focus_primary_button:!1},i=function(){e("body").addClass("backupbuddy-modal-open"),t.fadeIn("fast",(function(){e(document).trigger("backupbuddy.modal.show")}))},d=function(t){a=e.extend(!0,{},n,t),s(t),r()},r=function(){!1===t?(t=e(".backupbuddy-modal")).length?(o(),l()):t=c():(o(),l()),a.theme&&t.addClass("theme-"+a.theme),a.mode&&t.addClass("mode-"+a.mode),a.title?p(a.title):t.addClass("no-title"),a.content&&u(a.content),a.size&&b(a.size)},o=function(){t.html(""),t.removeClass("no-title"),t.removeClass((function(e,t){var a=(t.match(/(^|\s)theme-\S+/g)||[]).join(" ");return a=((a=(a.match(/(^|\s)mode-\S+/g)||[]).join(" ")).match(/(^|\s)size-\S+/g)||[]).join(" ")})),e(document).trigger("backupbuddy.modal.reset")},s=function(e){a.mode&&(void 0!==e.size&&void 0!==e.size.width||(a.size.width=500),"alert"===a.mode&&(void 0===e.close_on_background_click&&(a.close_on_background_click=!1),void 0===e.disable_close_button&&(a.disable_close_button=!0),void 0===e.focus_primary_button&&(a.focus_primary_button=!0)))},u=function(a){a instanceof jQuery||e.isArray(a)?t.find(".backupbuddy-modal-content").html("").append(a):t.find(".backupbuddy-modal-content").html(a)},c=function(){return t=e("<div />").addClass("backupbuddy-modal").hide(),e("#wpwrap").prepend(t),l(),e(document).trigger("backupbuddy.modal.create"),e(".backupbuddy-modal")},l=function(){var n=e("<div />").addClass("backupbuddy-modal-background"),i=e("<div />").addClass("backupbuddy-modal-inner"),d=e("<div />").addClass("backupbuddy-modal-content"),r=e("<h4 />").addClass("backupbuddy-modal-title"),o=e("<a />").addClass("backupbuddy-modal-close").attr("href","#close").html("&times;");if("alert"===a.mode||"confirm"===a.mode||"prompt"===a.mode){var s=e("<div />").addClass("backupbuddy-modal-dialog"),u=e("<div />").addClass("backupbuddy-modal-dialog-body"),c=e("<div />").addClass("backupbuddy-modal-dialog-actions"),l=e("<button />").addClass("button button-primary");if(l.on("click",(function(t){return t.preventDefault(),"function"==typeof a.prompt&&a.prompt(e(".backupbuddy-modal-prompt-input").val()),f(a.callbacks.primary)})),"alert"===a.mode)var p=l.html(a.strings.alert_button);else if("confirm"===a.mode){var b=e("<button />").addClass("button button-secondary").html(a.strings.confirm_negative);b.on("click",(function(e){return e.preventDefault(),f(a.callbacks.secondary)}));p=[b,l.html(a.strings.confirm_affirmative)]}else if("prompt"===a.mode)p=l.html(a.strings.prompt_button);if(c.append(p),u.append(d),"prompt"===a.mode){var g=e("<input/>").addClass("backupbuddy-modal-prompt-input").attr("type","text");g.on("keyup",(function(e){"Enter"===e.key&&l.trigger("click")})),"string"==typeof a.prompt_default&&a.prompt_default&&g.val(a.prompt_default),u.append(g)}s.append(u).append(c),d=s}o.on("click",(function(e){e.preventDefault(),k()})),n.on("click",(function(){a.close_on_background_click&&h()})),a.disable_close_button||i.append(o),i.append(r).append(d),t.append(n).append(i),e(document).trigger("backupbuddy.modal.build")},p=function(e){t.find(".backupbuddy-modal-title").html(e)},b=function(e){if(e&&"string"==typeof e)t.addClass("size-"+e);else if("object"===_typeof(e)){if(void 0===e.width&&void 0===e.height)return;void 0!==e.width&&t.find(".backupbuddy-modal-inner").css("width",e.width),void 0!==e.height&&t.find(".backupbuddy-modal-inner").css("height",e.height)}},f=function(e,t){"function"==typeof e&&e(t)},k=function(a){e("body").removeClass("backupbuddy-modal-open"),t&&t.length&&_()?t.fadeOut("fast",(function(){f(a),e(document).trigger("backupbuddy.modal.close")})):(f(a),e(document).trigger("backupbuddy.modal.close"))},g=function(){k((function(){y(),e(document).trigger("backupbuddy.modal.destroy")}))},y=function(){!1!==t&&(t.length&&(t.remove(),t=!1),e(document).trigger("backupbuddy.modal.remove"))},h=function(){"confirm"===a.mode?a.callbacks.secondary():k()},m=function(){a.close_with_esc_key&&e(document).keyup((function(e){"Escape"===e.key&&h()}))},_=function(){return!1!==t&&t.is(":visible")};return{init:function(){m()},open:function(t){_()||g(),d(t),e(document).trigger("backupbuddy.modal.open"),_()||i(),"prompt"===a.mode?e(".backupbuddy-modal-prompt-input").focus():a.focus_primary_button&&e(".backupbuddy-modal-dialog-actions .button-primary").focus()},close:k,content:u,destroy:g,set_size:b,find:function(e){return t.find(e)}}}(jQuery),jQuery(window).on("load",BackupBuddy.Modal.init),(BackupBuddy=window.BackupBuddy||{}).New_Backup=function(e){"use strict";pb_backupbuddy_profile_updated=function(t,a){e("#profile_title_"+t).text(a)};var t=function(){e(".profile_item_select").on("click",(function(t){t.preventDefault();var a=e(this).attr("href");return a+="&after_destination="+e("#pb_backupbuddy_backup_remotedestination").val(),a+="&delete_after="+e("#pb_backupbuddy_backup_deleteafter").val(),window.location.href=a,!1}))},a=function(){e("#pb_backupbuddy_afterbackupremote_box").on("change",(function(){e(this).is(":checked")?tb_show("Solid Backups",BackupBuddy.Vars.get("ajax.destination_picker")+"&callback_data=delayed_send&sending=1&action_verb=to%20send%20to&TB_iframe=1&width=640&height=455",null):(e("#pb_backupbuddy_backup_remotedestination").val(""),e("#pb_backupbuddy_backup_deleteafter").val(""),e("#pb_backupbuddy_backup_remotetitle").html(""))}))},n=function(){e("body").on("thickbox:removed",(function(){""===e("#pb_backupbuddy_backup_remotedestination").val()&&e("#pb_backupbuddy_afterbackupremote_box").removeAttr("checked")}))},i=function(){e(".profile_settings").click((function(t){return tb_show("Profile Settings",BackupBuddy.Vars.get("ajax.profile_settings")+"&profile="+e(this).attr("rel")+"&callback_data="+e(this).attr("rel")+"&TB_iframe=1&width=640&height=455",null),!1}))},d=function(){e("#pb_backupbuddy_profileadd_plusbutton").on("click",(function(t){return t.preventDefault(),e(this).hide(),e("#pb_backupbuddy_profileadd").show(),!1}))};return{init:function(){t(),a(),n(),i(),d()}}}(jQuery),jQuery(window).on("load",BackupBuddy.New_Backup.init),(BackupBuddy=window.BackupBuddy||{}).Restore=function(e){"use strict";var t=!1,a=0,n=!1,i=0,d=function(){e('.backupbuddy-file-tree input[type="checkbox"]:not([data-restore-bound="true"])').each((function(){var t=e(this);t.attr("data-restore-bound","true"),t.on("change",(function(){var e=t.val();t.is(":checked")?r(e):l(e)}))}))},r=function(t){if(!function(t){return e('#backupbuddy-restore-ui li[data-path="'+t+'"]').length}(t)){var a=o(t),n=backupbuddy_basename(t),i=backupbuddy_is_dir(t),d=e("<em/>").html(n),r=e("<li/>").attr("data-path",t).append(d),s=e("<a />").addClass("remove-file").attr("href","#"+t).html("&#10005;");s.on("click",(function(t){t.preventDefault();var a=e(this).attr("href").replace("#","");e('input[value="'+a+'"]').trigger("click")})),r.append(s),i&&r.addClass("folder"),i||"backupbuddy-restore-ui"!==a.attr("id")?a.find("li.folder:last").length?a.find("li.folder:last").after(r):a.append(r):a.find("li.dir").length?a.find("li.dir").before(r):a.append(r),e(".backupbuddy-restore-list .instructions").hide(),e(".backupbuddy-restore-list .button").show(),u(),backupbuddy_autoscroll(e("#backupbuddy-restore-ui"))}},o=function(t){backupbuddy_is_dir(t),t=backupbuddy_trim_slashes(t);var a=s(t),n=e('ul[data-folder="'+a+'"]');return n.length||(n=c(a)),n},s=function(e){return backupbuddy_trim_slashes(e.replace(backupbuddy_basename(e),""))},u=function(){var t=y(),a="Restore";t&&(a+=" "+t),e(".button-restore").val(a)},c=function(t){var a=e("#backupbuddy-restore-ui"),n=e("<li />").attr("data-path",t).addClass("dir").html("<span>"+t+"</span>"),i=e("<ul />").attr("data-folder",t);return t?(n.append(i),a.append(n),i):a},l=function(t){var a=e('#backupbuddy-restore-ui li[data-path="'+t+'"]'),n=a.parent("ul");a.remove(),n.find("li").length||(n.parent("li").remove(),"backupbuddy-restore-ui"!==n.attr("id")&&n.remove()),e("#backupbuddy-restore-ui li").length||(e(".backupbuddy-restore-list .instructions").show(),e(".backupbuddy-restore-list .button").hide()),u()},p=function(){if(!t&&(t=!0,e(".backupbuddy-restore-list").length)){var a=e(".backupbuddy-restore-list"),n=a.offset().top-e("#wpadminbar").outerHeight(),i=e("#backupbuddy-data-browser");e(window).on("scroll",(function(){var t=e(window).scrollTop();n<t&&i.height()+i.offset().top-a.height()>t?a.addClass("stuck"):a.removeClass("stuck")}))}},b=function(){e("#backupbuddy-restore-status .abort-link").on("click",(function(t){if(t.preventDefault(),n)return!1;a=1,e(".restore-current-step").html(BackupBuddy.Vars.get("strings.aborting_restore"))})),e('a[href="#abort-restore"]').on("click",(function(t){t.preventDefault();var a=e(this).attr("data-restore-id");e('input[name="abort-'+a+'"]').val("1"),e('.restore-in-progress[data-restore-id="'+a+'"]').html(BackupBuddy.Vars.get("strings.aborting_restore"))}))},f=function(){if(e("#backupbuddy-restore-status").hasClass("in-progress")){var t=!!e("#backupbuddy-restore-status").attr("data-restore-id")&&e("#backupbuddy-restore-status").attr("data-restore-id");k(t)}},k=function t(i){return void 0===i&&(i=e("#backupbuddy-restore-status").attr("data-restore-id")),i?BackupBuddy.Restore.is_polling?(setTimeout((function(){t(i)}),1e3),!1):(BackupBuddy.Restore.is_polling=!0,e(".tab.restore-backup").addClass("processing"),void e.ajax({url:BackupBuddy.Vars.get("ajax.restore_status"),data:{restore_id:i,abort:a},contentType:"application/json; charset=utf-8",dataType:"json",success:function(d){if(BackupBuddy.Restore.is_polling=!1,void 0!==d.success)if(d.overlapping)setTimeout((function(){t(i)}),5e3);else if(d.success)!function(t){a&&(t.text=BackupBuddy.Vars.get("strings.aborting_restore")),e(".restore-current-step").html(t.text),t.locked&&(n=!0,e("#backupbuddy-restore-status .abort-link").fadeOut("fast"));var i=e(".progress-dots"),d=!1;if(t.dot&&i.find("."+t.dot).length){if(i=i.find("li"),"failed"===t.end_status)return i.find("li.loading").removeClass("loading"),i.find("li.active:last").removeClass("active").addClass("failed"),!1;i.each((function(){if(!0===d)return e(this).addClass("loading"),!1;e(this).addClass("active").removeClass("loading"),e(this).hasClass(t.dot)&&(d=!0)}))}}(d.status),d.is_done?function(t){var a=e(".restore-done");if(e(".restore-status-container").css("height",e(".restore-status-container").outerHeight()),"failed"===t.end_status?(a.find(".status-complete").hide(),a.find(".status-failed").show()):"aborted"===t.end_status&&(a.find(".status-complete").hide(),a.find(".status-aborted").show()),t.error)if(a.find("p.error").length)a.find("p.error").html(t.error);else{var n=e("<p/>").addClass("error").html(t.error);a.find("h2.status-failed").after(n)}e(".tab.restore-backup").removeClass("processing"),e(".restore-active").fadeOut("fast",(function(){a.fadeIn("fast",(function(){e(".restore-status-container").removeAttr("style")}))}))}(d.status):setTimeout((function(){t(i)}),3e3);else{if(void 0!==d.error)return void console.log("Restore Poll Error: "+d.error);i?g(i):console.log("Restore ID is missing.")}else g(i)},statusCode:{404:function(){g(i)},500:function(){g(i)}},error:function(e,t,a){console.log(a),g(i)}}).fail((function(e,t,a){console.log(a),g(i)}))):(console.log("Missing restore ID."),!1)},g=function(e){BackupBuddy.Restore.is_polling=!1,++i<5?setTimeout((function(){k(e)}),5e3):location.reload()},y=function(t){var a=(t=void 0===t?e("#backupbuddy-data-browser form").serializeObject():t).backupbuddy_restore,n=0,i=0;if(!a)return!1;e.isArray(a)||(a=new Array(a));for(var d=0;d<a.length;d++)backupbuddy_is_dir(a[d])?i++:n++;if(!n&&!i)return!1;var r="";if(i){var o=1===i?BackupBuddy.Vars.get("strings.folder"):BackupBuddy.Vars.get("strings.folders");r=i+" "+o}return n&&(r&&(r+=" & "),r+=n+" "+(o=1===n?BackupBuddy.Vars.get("strings.file"):BackupBuddy.Vars.get("strings.files"))),r},h=function(){e('a[href^="#restore-details-"]').off("click").on("click",(function(t){t.preventDefault(),e(e(this).attr("href")).toggleClass("open")}))},m=function(){e('#backupbuddy-data-browser form:not([data-bound="true"])').each((function(){var t=e(this);t.attr("data-bound","true"),t.on("submit",(function(a){a.preventDefault();var n=e(this).serializeObject();if(!y(n))return!1;v("partial",(function(){n.backupbuddy_zip=t.attr("data-zip"),n.backupbuddy_restore_type="files",n.backupbuddy_restore_tables="",e.ajax({url:BackupBuddy.Vars.get("ajax.restore"),data:n,type:"post",success:function(t){if(t.success)k(t.restore_id),e(".tab.restore-backup").addClass("processing"),e(".backupbuddy-restore-header").slideUp("fast"),e("#backupbuddy-data-browser").slideUp("fast",(function(){e("#backupbuddy-data-browser").addClass("hidden"),e("#backupbuddy-restore-status").addClass("open")}));else{var a=e("<p/>").addClass("error").html(t.error);BackupBuddy.Modal.open({mode:"alert",content:a})}}}),BackupBuddy.Modal.close()}))}))}))},_=function(){e("a.restore-full-backup").off("click").on("click",(function(t){t.preventDefault();var a=e(this),n=a.attr("data-what"),i=a.attr("href"),d=a.attr("data-zip"),r=a.attr("data-destination-id"),o=function(){var t=n||BackupBuddy.Modal.find('input[name="full-restore-type"]:checked').val();if(!t){var a=BackupBuddy.Modal.find("ul.full-restore-options"),o=BackupBuddy.Modal.find(".error");return o.length||(o=e("<p />").addClass("error"),a.before(o)),o.html(BackupBuddy.Vars.get("strings.select_restore_type_error")).show(),!1}var s="full";"db"===t?s+="_db":"files"===t&&(s+="_files"),v(s,(function(){BackupBuddy.Modal.open({title:"Restoring from Backup",content:e("<p/>").css("text-align","center").html(BackupBuddy.Vars.get("strings.starting_restore"))}),e.ajax({url:BackupBuddy.Vars.get("ajax.restore"),data:{backupbuddy_zip:d,backupbuddy_restore:"*",backupbuddy_restore_tables:"*",backupbuddy_restore_destination:r,backupbuddy_restore_type:t},type:"post",success:function(t){t.success?(i=x("restore="+encodeURI(t.restore_id),i),window.location.replace(i)):t.error&&BackupBuddy.Modal.content(e("<p/>").addClass("error").css("text-align","center").html(t.error))}})}))};if(n)o();else{var s=e("#backupbuddy-select-restore-type").clone();s.addClass(s.attr("id")).removeAttr("id").removeAttr("style"),s.find('input[type="radio"]:first').attr("checked","checked"),BackupBuddy.Modal.open({title:BackupBuddy.Vars.get("strings.select_restore_title"),content:s,mode:"confirm",strings:{confirm_affirmative:BackupBuddy.Vars.get("strings.continue")},callbacks:{primary:o}})}}))},v=function(t,a){var n="backupbuddy-confirm-"+(t=void 0===t?"partial":t)+"-restore",i="backupbuddy-"+t+"-restore-confirm",d=e("<input />").attr("type","checkbox").attr("value","1").attr("id",n),r=[e("<div />").attr("id",i).html(BackupBuddy.Vars.get("strings.confirm_"+t+"_restore")),e("<label/>").html(BackupBuddy.Vars.get("strings.confirm_"+t+"_restore_cbx")).prepend(d)];BackupBuddy.Modal.open({title:BackupBuddy.Vars.get("strings.confirm_restore_title"),content:r,mode:"confirm",strings:{confirm_affirmative:BackupBuddy.Vars.get("strings.confirm_restore_affirmative")},callbacks:{primary:function(){if(e("#"+n).is(":checked"))return a(),!0;var t=e("#"+i).find(".error");return t.length||(t=e("<p />").addClass("error"),e("#"+i).append(t)),t.html(BackupBuddy.Vars.get("strings.confirm_restore_error")).show(),!1}}})},B=function(){e(".restore-in-progress").each((function(){var t=e(this).attr("data-restore-id");w(t)}))},w=function t(a){if(BackupBuddy.Restore.is_polling)return setTimeout((function(){t(a)}),1e3),!1;var n=e('input[name="abort-'+a+'"]').val();BackupBuddy.Restore.is_polling=!0,e.ajax({url:BackupBuddy.Vars.get("ajax.restore_status"),data:{restore_id:a,abort:n},contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if(BackupBuddy.Restore.is_polling=!1,void 0!==i.success)if(i.overlapping)setTimeout((function(){t(a)}),5e3);else if(i.success){var d=e('.restore-in-progress[data-restore-id="'+a+'"]');if("1"===n?d.html(BackupBuddy.Vars.get("strings.aborting_restore")):d.html(i.status.text),i.locked&&e('a[href="#abort-restore"][data-restore-id="'+a+'"]').fadeOut("fast"),i.is_done){var r=d.parents("td:first");r.html(i.status.text),r.next("td").html(i.status.html),e("tr#restore-details-"+a).find("td:first").html(i.status.details),h()}else setTimeout((function(){t(a)}),3e3)}else{if(void 0!==i.error)return void console.log("Restore Poll Error: "+i.error);a?C(a):console.log("Restore ID is missing.")}else t(a)},statusCode:{404:function(){C(a)},500:function(){C(a)}},error:function(e,t,n){console.log(n),C(a)}}).fail((function(e,t,n){console.log(n),C(a)}))},C=function(e){BackupBuddy.Restore.is_polling=!1,++i<5?setTimeout((function(){w(e)}),5e3):location.reload()},x=function(e,t){var a="",n=t;return t.indexOf("#")>=0&&(n=t.split("#")[0],a="#"+t.split("#")[1]),n.indexOf("?")>=0?n+="&"+e:n+="?"+e,n+a},j=function(){e(".toggle-restore-archive").on("click",(function(t){t.preventDefault(),e(".backupbuddy-restore-archive").toggleClass("hidden");var a="show"===e(this).text().toLowerCase()?"Hide":"Show";e(this).text(a)}))},H=function(){e(".delete-restore").on("click",(function(t){t.preventDefault();var a=e(this).attr("rel"),n="true"===e(this).attr("data-corrupt")?"1":"0",i=e(this).parents("tr"),d=i.next("tr:first");BackupBuddy.Modal.open({mode:"confirm",title:"Delete Restore",content:"Are you sure you want to delete this restore? This cannot be undone!",callbacks:{primary:function(){e.ajax({url:BackupBuddy.Vars.get("ajax.restore_delete"),data:{id:a,corrupt:n},dataType:"json",success:function(t){t.success?(i.remove(),d.remove(),e(".backupbuddy-restore-archive tbody tr").length||(e(".backupbuddy-restore-archive").prev("h4").remove(),e(".backupbuddy-restore-archive").remove()),BackupBuddy.Modal.close()):BackupBuddy.Modal.open({mode:"alert",title:"Restore Delete Error",content:"There was a problem deleting the restore: "+t.error})}})}}})}))};return{init:function(){_(),d(),p(),m(),h(),b(),f(),B(),j(),H()},is_polling:!1,bind_restore_buttons:_}}(jQuery),jQuery(window).on("load",BackupBuddy.Restore.init);BackupBuddy=window.BackupBuddy||{};var checkEmailNotifyErrorStatus,pb_settings_changed=!1;BackupBuddy.Settings=function(e){"use strict";var t="backupbuddy_page_pb_backupbuddy_settings",a="."+t+" ",n=function(){e("#pb_backupbuddy_email_notify_error").length&&(""===e("#pb_backupbuddy_email_notify_error").val()?(e("#pb_backupbuddy_email_notify_error").css("background-color","#FFA1A1"),e("#emailErrorNotifyHiddenAlert").show()):(e("#pb_backupbuddy_email_notify_error").css("background-color","#FFF"),e("#emailErrorNotifyHiddenAlert").hide()))},i=function(){e(".pb_backupbuddy_customize_email_scheduled_start").on("click",(function(t){t.preventDefault(),e(".pb_backupbuddy_customize_email_scheduled_start_row").toggleClass("d-none")})),e(".pb_backupbuddy_customize_send_finish").on("click",(function(t){t.preventDefault(),e(".pb_backupbuddy_customize_email_send_finish_row").toggleClass("d-none")})),e(".pb_backupbuddy_customize_email_scheduled_complete").on("click",(function(t){t.preventDefault(),e(".pb_backupbuddy_customize_email_scheduled_complete_row").toggleClass("d-none")})),e(".pb_backupbuddy_customize_email_error").on("click",(function(t){t.preventDefault(),e(".pb_backupbuddy_customize_email_error_row").toggleClass("d-none")}))},d=function(){e("#pb_backupbuddy_email_error_test").on("click",(function(){return e.post(BackupBuddy.Vars.get("ajax.email_error_test"),{email:e("#pb_backupbuddy_email_notify_error").val()},(function(t){"1"!=(t=e.trim(t)).charAt(0)?BackupBuddy.Modal.open({mode:"alert",content:BackupBuddy.Vars.get("strings.error_testing")+":\n\n"+t}):BackupBuddy.Modal.open({mode:"alert",content:BackupBuddy.Vars.get("strings.email_test_sent")+"\n\n"+t.slice(1)})})),!1}))},r=function(){e(document).on("backupbuddy.tabs.switch",(function(a,n){e("body").hasClass(t)&&"#advanced"===n&&e(".nav-tab-2").trigger("click")}))},o=function(){e("#pb_backupbuddy_email_notify_error").on("change",(function(){n()}))},s=function(){e(a+".backupbuddy-tabs .tab-controls a").on("click",(function(e){!0===pb_settings_changed&&(BackupBuddy.Modal.open({mode:"alert",content:"You have made changes without saving! Be sure to save your changes!"}),pb_settings_changed=!1)})),e(a+".pb_form").on("change",(function(){pb_settings_changed=!0}))};return{init:function(){i(),d(),r(),n(),o(),s()}}}(jQuery),jQuery(window).on("load",BackupBuddy.Settings.init),(BackupBuddy=window.BackupBuddy||{}).Tabs=function(e){"use strict";var t=function(){if(e(".backupbuddy-tabs").length){e(".backupbuddy-tabs .tab-controls a").on("click",(function(t){t.preventDefault();var n=e(this).attr("href");"#"===n.charAt(0)?a(n):window.location.replace(n)}));var t=window.location.hash;t&&a(t)}},a=function(t){var a=e('.backupbuddy-tabs .tab-controls a[href$="'+t+'"]').parent("li"),n=e(t);a.length&&n.length&&(e(".backupbuddy-tabs .tab-controls .active").removeClass("active"),a.addClass("active"),e(".backupbuddy-tabs .tab-contents.active").removeClass("active"),n.addClass("active"),e(document).trigger("backupbuddy.tabs.switch",t),history.pushState?history.pushState(null,null,t):window.location.hash=t)};return{init:function(){t()}}}(jQuery),jQuery(window).on("load",BackupBuddy.Tabs.init),(BackupBuddy=window.BackupBuddy||{}).Vars=function(e){"use strict";var t=function(e){return void 0!==backupbuddy_vars.ajax_base&&backupbuddy_vars.ajax_base+e};return{get:function(e){if("undefined"==typeof backupbuddy_vars)return!1;for(var a=e,n=backupbuddy_vars,i=!1;a.indexOf(".")>=0;){i=a.split(".")[0];a=e.replace(i+".",""),void 0!==n[i]&&(n=n[i])}return void 0===n[a]?"ajax"===i&&t(a):n[a]},get_ajax_url:t}}(jQuery);
